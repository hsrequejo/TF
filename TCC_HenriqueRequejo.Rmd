---
title: "Esqueleto do TF"
author: "Henrique S Requejo"
date: "19/03/2021"
header-includes:
    \AtBeginDocument{\let\maketitle\relax}
output:
  pdf_document:
    latex_engine: xelatex
    number_sections: true
    fig_caption: yes
    includes:
            in_header: preamble.tex
citation_package: biblatex
bibliography: references.bib
biblio-style: apalike
csl: apa.csl
urlcolor: blue
linkcolor: black
fontsize: 12pt
---

```{=html}
<!--

Este código usa o arquivo bats.RData e ants.RData para gerar o documento.
Estes dois arquivos devem estar no mesmo diretório deste .Rmd

Variaveis presentes no .RData:

gammas = vetor com os gammas que foram analisados
vec_W = vetor com os valores de omega utilizados
iterations = numero de iteracoes usados
partitions_of_omega = numero de perticoes de omega (TODO: da pra ser extraido de Vec_W)
links = dataframe dos links, convertido do csv no script motor
nodes = dataframe dos nodes, convertido de um csv no script motor
layout = layout da disposicao da rede, calculado no script motor
seq_Gnorm_gamma_mean = Dataframe com as informaçãoes de Gnorm medio em relacao a omega e gamma
G_norm_mean = Os valores médios de Gnorm do ensaio na mesma ordem de entrada (alfabetico pelo nome do noh)
G_norm_mean_ordered = Os valores médios de Gnorm do ensaio ordenados
net_name = string com o nome da rede
bib_ref = Referencia bibliografica da rede como no biblatex

-->
```
<!-- As opcoes message = FALSE e warning = FALSE servem para não mostrar As mensagens do console e Warnings no PDF -->

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.pos = 'H', fig.align="center")

```

```{r bibliotecas_e_funcoes_auxiliares}

library(multinet)
library(igraph)
library(plyr)
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library(kableExtra)
library(akima)
library(plot3D)
library(fs)

#setwd(dirname(rstudioapi::getActiveDocumentContext()$path))

source("Aux_functions.R", encoding="utf-8") # importante a opção UTF-8 devido ao acentos nos plots


```

<!-- Sem numero de pagina -->

\pagenumbering{gobble}

\include{Capa.tex}

\pagebreak

\tableofcontents

\pagebreak

<!-- Começa a numeracao de pagina -->

\pagenumbering{arabic}

# Resumo

Análises de modularidade e centralidade oriundas da ciência de redes têm sido usadas na Ecologia para operacionalizar conceitos como guilda, grupo funcional e papel funcional. Contudo, essas análises têm sido feitas apenas para redes monocamada, ou seja, que contém só um tipo de interação e, portanto, apenas uma classe de arestas. No caso do algoritmo de modularidade Louvain, uma das grandes diferenças entre a tradicional versão monocamada e a versão multicamada é a constante de acoplamento. Essa constante, implementada no algoritmo multicamada, torna possível que um mesmo nó pertença a dois módulos diferentes em camadas diferentes. Neste projeto, queremos identificar os nós que resistem ao aumento dessa força de acoplamento entre camadas, permanecendo em mais de um módulo em diferentes camadas ao aumentarmos essa força. Em redes de interações ecológicas, esses nós resistentes devem representar espécies que desempenham papéis funcionais importantes. Por exemplo, animais que são importantes tanto para a polinização, quanto para a dispersão de sementes de duas ou mais famílias de plantas. Para classificar as espécies com relação à sua importância, comparamos curvas da variação no número de módulos aos quais cada nó pertence em função da variação na constante de acoplamento e do parâmetro de resolução. Assim, selecionamos os nós que apresentam menor decaimento de módulos, ou seja, que permanecem em mais de um módulo mesmo que seja alta a força de acoplamento entre camadas, considerando diferentes cenários de resolução. Criamos uma nova métrica de centralidade chamada de $G_{norm}$ para quantificar essa relação entre quantidade de módulos e força de acoplamento entre camadas. Para testar essa nova métrica, analisamos redes de interações multicamada baseadas em dados de campo: uma entre morcegos e plantas e outra entre formigas e plantas. Os nós com alto $G_{norm}$ possuem uma boa intersecção com os nós mais centrais da rede, porém o seu ranking de importância diferiu. Alguns nós que não possuiam altos valores de centralidade monocamada apresentaram altos valores de $G_{norm}$, mostrando que pode haver ganho de informação na abordagem multicamada em comparação à monocamada. Isso pode ajudar a encontrar espécies que sejam mais importantes do que outras para manter funções e serviços ecossistêmicos vitais em sistemas naturais.

<!-- Não precisa incluir citações no resumo. Deixe-as para o corpo do texto. -->

\pagebreak

# Modularidade de Newman e Girvan

A ciência de redes tem sido usada para investigar sistemas ecológicos desde o século XIX [@Ings2018]. Dentre vários avanços, essa abordagem nos permitiu entender melhor como diferentes espécies afetam umas às outras por meio de interações diretas e indiretas [@guimarães2017]. Esse entendimento levou a importantes *insights* sobre a estrutura, função e dinâmica de redes de interações [@Pilosof2017].

Uma forma de obtermos estes *insights* é olharmos para a estrutura modular da rede, que pode revelar alguns padrões escondidos em meio ao emaranhado de nós e conexões. Estes módulos são compostos por nós mais conectados entre si do que com outros nós de fora do módulo. A capacidade de encontrar e analisar esses módulos pode ser muito útil para entendermos mais a fundo a estrutura e a dinâmica das redes complexas [@Newman2004a], incluindo as redes de interações.

É relativamente fácil identificar módulos em redes pequenas e pouco conectadas, como a grande maioria das redes de interações estudadas até o momento [@dormann2017]. Porém, essa tarefa se torna muito difícil quando analisamos redes mais complexas, com milhares, ou até mesmo milhões, de nós distribuídos em várias camadas. Então como podemos identificar módulos nessas redes maiores e mais complexas? Existem muitas formas, como por exemplo métodos aglomerativos, divisivos, baseados em cliques e de otimização da modularidade. Aqui focamos na otimização da modularidade.

Para otimizarmos a modularidade, precisamos de uma métrica que indique se uma dada divisão da rede em módulos é melhor do que outra, para então buscarmos qual seria a melhor divisão de módulos possível. Uma métrica para medir a qualidade da modularidade de redes foi definida pela primeira vez por Newman e Girvan [@Newman2004a] como:

```{=tex}
\begin{equation} \label{eq:mod_basica}
    Q = \sum^{k}_{i=1}(e_{ii}-a^2_i)
\end{equation}
```
Onde $e_{ii}$ representa a fração das conexões observadas dentro do módulo $i$ em relação ao total de conexões dentro da rede e $a^2_i$ representa a quantidade esperada de conexões no módulo $i$.

Essa equação tem servido de base para a maioria das métricas de modularidade desenvolvidas deste então [@fortunato2016]. Para determinarmos a proporção de conexões dentro dos módulos, suponha que tenhamos uma possível divisão de módulos dentro da rede representada pela matriz de adjacência $A_{ij}$. Sendo $C_i$ o módulo que o nó $i$ está contido, então a fração de conexões que conectam os vértices que estão dentro de um mesmo módulo é:

```{=tex}
\begin{equation} \label{eq:fracao_conect}
    \frac{\sum_{ij} A_{ij} \delta (c_i, c_j)}{\sum_{ij} A_{ij}} = \frac{1}{2m} \sum_{ij} A_{ij} \delta (c_i, c_j) 
\end{equation}
```
Onde $\delta$ é o delta de Kronecker, que retorna o valor 1 caso $c_i = c_j$ e zero caso contrário; a variável $m$ representa o número total de conexões da rede.

Falta agora definirmos uma forma de medir a quantidade esperada de nós dentro do módulo. Se conectarmos os vértices de forma aleatória, preservando os graus de cada nó, representados pela variável $k$, temos que a probabilidade de existir uma conexão entre os nós $i$ e $j$ é $k_i k_j / 2m$ . Dessa forma, temos que a modularidade descrita acima pode ser rescrita de uma forma mais operacional [@Blondel2008] como:

```{=tex}
\begin{equation} \label{eq:blondel}
    Q = \frac{1}{2m} \sum_{ij} (A_{ij} - \frac{k_i k_j}{2m}) \delta(c_i c_j)
\end{equation}
```
Os valores da modularidade descrita acima variam entre 0 (zero) e 1 (um).

\pagebreak

# Método Louvain para otimização de modularidade

Se dividirmos a rede em módulos e o valor de modularidade definido por Newman e Girvan for alto, temos que a divisão de módulos escolhida é boa. Dessa forma, basta dividirmos a rede em diferentes módulos visando maximizar o valor da modularidade Newman-Girvan. Porém, esta não é uma tarefa fácil, já que a otimização de modularidade é um problema NP-difícil [@Brandes2008]. Um problema NP-difícil (Non Deterministic Polynomial Time) é um problema que leva um tempo exponencial para ser resolvido, por exemplo $O(2^N)$. Um problema NP demora muito para serem computado, se pegarmos o caso que a complexidade seja exponencial $O(2^N)$ e $N$ (tamanho da entrada) seja igual a 100, sob essas condições, o programa demoraria um tempo maior do que a idade do universo para ser resolvido. Um problema NP-difícil é um problema que é ao menos tão difícil quanto um problema NP-completo.

Esta dificuldade computacional em dividir redes em módulos significativos motivou a procura por métodos heurísticos para encontrar agrupamentos que apresentem um alto valor de modularidade com uma complexidade razoável. Este é o caso do método Louvain [@Blondel2008], que parece funcionar em um tempo $O(M)$, onde $M$ representa o número total de conexões da rede, ou seja, é resolvido em tempo polinomial, neste caso, linear com relação ao número de nós da rede. Essa complexidade computacional permite que redes de grande escala possam ser analisadas em tempo razoável, além de ser simples e de fácil implementação.

A implementação do algoritmo Louvain consiste em dois passos básicos [@Blondel2008]. O primeiro passo agrupa os nós em módulos de forma individual, favorecendo otimizações locais de modularidade. O segundo passo transforma a rede original em uma nova rede simplificada, cujo os novos nós são os módulos do passo anterior. As conexões entre estes novos nós correspondem à soma das conexões entre os módulos e cada nó agora tem um laço (conexão que liga um nó a si mesmo) cujo peso é a soma das conexões dentro do módulo correspondente. Esses dois passos são repetidos até que não exista mais aumento no valor da modularidade. A figura \ref{fig:algoritmo_Louvain} ilustra o algoritmo.

```{=tex}
\begin{figure}[H] 
\centering
\includegraphics[width=0.8\textwidth]{./Figuras/Algoritmo_Louvain.png}
\caption{Extraído de Blondel et al. (2008). Visualização dos passos do algoritmo Louvain. Cada passo é feito em duas fases: uma onde a modularidade é otimizada permitindo somente mudanças locais de módulo e uma onde os módulos encontradas são agregadas e uma nova rede de módulos é construída.}
\label{fig:algoritmo_Louvain}
\end{figure}
```
Apesar de este ser um algoritmo ganancioso (*greedy*), ele apresenta boa detecção de módulos que possuem sentido quando aplicados em redes reais [@Blondel2008; @Meunier2009; @Zhang2010] e é mais rápido que outros algoritmos similares, como mostrado na tabela \ref{tab:tabela_blondel} (extraída de @Blondel2008). Outra vantagem do método é que não precisamos saber previamente o número de módulos em que a rede deve ser dividida.

```{=tex}
\begin{table}[h!]
  \caption{Extraído de Blondel et al. (2008). Comparação entre os tempos computacionais dos algoritmos Clauset et al (CNM), Pons e Latapy (PL), Wakita e Tsurumi (WT) e Louvain (LV). Os resultados mostram a modularidade obtida e o tempo computacional para cada rede/método. Células em branco representam tempos computacionais maiores que 24 horas.}
  \label{tab:tabela_blondel}
  \centering
  \resizebox{\textwidth}{!}{ 
\begin{tabular}{ c|ccccccc}
\hline
     & \textbf{Karate} & \textbf{Arxiv} & \textbf{Internet} & \textbf{Web nd.edu} & \textbf{Telefone} & \textbf{Web uk2005} & \textbf{WebBase 2001} \\
     \hline
     \hline
    \textbf{Nós / Conexões} & 34/77 & 9k/24k & 70k/351k & 325k/1M & 2.04M/5.4M & 39M/783M & 118M/1B \\
    \textbf{CNM} & 0.38/0s & 0.772/3.6s & 0.692/799s & 0.927/5034s & - & - & - \\
    \textbf{PL} & 0.42/0s & 0.752/3.3s & 0.729/575s & 0.895/6666s & - & - & - \\
    \textbf{WT} & 0.42/0s & 0.761/0.7s & 0.667/62s & 0.898/248s & 0.553/367s & - & - \\
    \textbf{LV} & 0.42/0s & 0.813/0s & 0.781/1s & 0.935/3s & 0.76/44s & 0.935/3s & 0.984/152min \\ \hline
\end{tabular}
}
\end{table}
```
Por outro lado, o método Louvain também apresenta limitações [@Good2010]. Dentre as mais expressivas estão o limite de resolução, o problema de degeneração e o fato de o algoritmo não ser determinístico. O problema de limite de resolução ocorre pois o algoritmo pode não parar nos módulos "intuitivos" devido a uma segunda passagem pela modificação dos módulos. Já o problema de degeneração ocorre pois podem existir muitas soluções com valor de modularidade próximos do máximo global, nesses casos é muito difícil encontrar o máximo global e realmente afirmar se ele possui significância científica maior do que a dos máximos locais com valores de modularidade similares.

Uma característica interessante do método é que não é possível, pela própria natureza do algoritmo, que um mesmo nó esteja presente em diferentes módulos. Essa sobreposição de módulos é chamada dentro da área de modularidade de redes de \textit{overlapping communities}. Porém, ao adaptarmos a forma de calcular a modularidade para multicamada [@Mucha2010], existe a possibilidade de que um mesmo nó pertença a diferentes módulos em diferentes camadas ao ajustarmos um parâmetro de entrada. Esta diferença é interessante e será usada para tentar encontrar espécies-chave que são boas conectoras entre grupos diferentes em camadas diferentes.

\pagebreak

# Modularidade multicamada

Apesar do amplo estudo de redes para compreensão de sistemas e tomada de decisão, redes do mundo real são normalmente estudadas de forma desconexa de outras redes ou então agregando-se várias redes em uma única rede [@Pilosof2017]. Uma maneira de aumentarmos as informações usadas no estudo de redes é usar redes multicamada. Quando usadas para representar sistemas ecológicos, as redes multicamada podem ter suas camadas definidas através de interações de diferentes tipos, ou que acontecem em diferentes localidades ou estações do ano, por exemplo [@Pilosof2017].

No presente estudo, focamos redes multicamada onde as camadas são definidas pelo tipo de interação, ou seja, onde todos os nós estão presentes em todas as camadas e apenas o tipo de conexão (interações) entre os nós é que muda entre camadas. Assim, nesse tipo de rede há duas classes maiores de arestas: intracamada, que conectam nós dentro de uma camada, e intercamada, que conectam um mesmo nó entre duas camadas. Este tipo de rede é chamada de \textit{multiplex} [@Mucha2010], que é uma subdivisão da grande categoria definida como redes multicamada.

Redes multiplex também podem ter sua modularidade analisada pelo método Louvain [@Mucha2010]. Essa adaptação consiste basicamente na mudança da forma como a função da modularidade é calculada, incluindo um parâmetro $\omega$ que controla o acoplamento entre as diferentes camadas da rede. Há também o parâmetro de resolução $\gamma$, que pode enviesar a tendência do algoritmo em encontrar módulos de escalas menores ou maiores. A generalização da equação de modularidade [@Mucha2010] é dada por:

```{=tex}
\begin{equation} \label{eq:1}
Q^{M} = \frac{1}{\mu} \sum_{ij\alpha\beta} \left[ \left(A_{i\alpha,j\alpha} - \gamma_{\alpha} \frac{k_{i\alpha} k_{j\alpha}}{2m_\alpha} \right) \delta_{\alpha,\beta} + \omega A_{i\alpha,j\beta} \delta_{ij} \right] \delta(c_{i\alpha}, c_{j \beta})
\end{equation}
```
Onde $\delta$ é o delta de kronecker, que retorna o valor 1 caso $c_{i\alpha} = c_{j \beta}$ e zero caso contrário; a variável $m$ representa a soma de do grau de cada nó na camada $\alpha$; $A_{i\alpha,j\alpha}$ é a matriz de adjacência na camada $\alpha$; $A_{i\alpha,j\beta}$ é a matriz de adjacência entre camadas; $k_{i\alpha}$ representa o grau do nó $i$ na camada $\alpha$ e $\mu = \sum_{i,j, \alpha}A_{i\alpha,j\alpha} + \omega \sum_{i,\alpha,\beta} A_{i\alpha,j\beta}$. Note que se utilizarmos $\omega = 0$ e $\gamma = 1$, a equação de modularidade generalizada (eq. \ref{eq:1}) é proporcional à média da modularidade monocamada [@Newman2004a; @Newman2004b] de cada camada. Isto também está descrito em @Bianconi2018, pg. 147-148:

```{=tex}
\begin{equation} \label{eq:2}
Q^{M} = \frac{1}{\mu} \sum_{\alpha} \frac{1}{2m_\alpha} \sum_{ij} \left(A_{i\alpha,j\alpha} - \gamma_{\alpha} \frac{k_{i\alpha} k_{j\alpha}}{2m_\alpha} \right) \delta(c_{i\alpha}, c_{j\alpha}) \end{equation}
```
# Parâmetros de acoplamento ($\omega$) e resolução ($\gamma$) na prática

Como a escolha dos parâmetros de resolução e acoplamento é arbitrária, surgem as perguntas: qual seria o melhor valor para aplicar em uma dada rede? Existe apenas um único valor adequado ou o valor a ser escolhido depende da pergunta que se pretende responder? Quais são os efeitos na prática quando variamos $\gamma$ e $\omega$? Com o objetivo de responder essas perguntas e auxiliar outros cientistas na escolha dos valores de $\gamma$ e $\omega$, analisamos essas questões em detalhes.

O parâmetro $\omega$ está contido no intervalo (0,1). Zero (0) representa o desacoplamento total das camadas (cada camada é tratada como uma rede independente) e a modularidade final é a média da modularidade de cada camada. Um (1) representa o acoplamento máximo, que faz com que a rede multiplex se comporte como uma rede monocamada. Na prática, isso significa que, quando aumentamos os valores da constante de acoplamento $\omega$, aumentamos o peso das arestas intercamada [@Mucha2010]. Isso faz com que as camadas tenham maior influência umas sobre as outras, favorecendo a formação de módulos multicamada. Quando diminuímos $\omega$, o contrário ocorre, o que favorece a formação de módulos monocamada.

<!-- É importante padronizar o vocabulário ao longo do texto. Na teoria de grafos: elemento = vértice, conexão = aresta, estrutura = topologia etc. Na teoria de redes: elemento = nó, conexão = elo, estrutura = arquitetura. É importante então não usar de forma intercambiável termos como conexão, link e aresta. Eles são  personagens da sua história, logo, precisam ser nomeados de forma consistente. Escolha um dos dialetos e siga com ele. -->

O parâmetro de resolução foi introduzido por @Reichardt2006 para avaliar redes monocamada e depois estendido para a modularidade generalizada multicamada [@Mucha2010]. De uma forma geral, se $\gamma_2 > \gamma_1$, os módulos encontrados com $\gamma_2$ possuem menos nós (módulos menores) e são mais numerosos (maior quantidade de módulos). Os módulos encontrados com $\gamma_2$ podem ser submódulos dos obtidos usando $\gamma_1$, mas nem sempre é o caso [@Reichardt2006]. Lembrando que $0 \leq \gamma \leq \infty$. Porém, não faz sentido aumentarmos $\gamma$ para valores muito altos, já que existe um limite a partir do qual os módulos se tornam tão pequenos que cada módulo passa a ter como integrante apenas um nó.

Vamos usar uma rede multiplex clássica na literatura, Famílias de Florença [@Kent1978], para ilustrar graficamente o que ocorre quando variamos os parâmetros $\omega$ e $\gamma$. Essa rede foi escolhida por ser pequena, o que facilita sua visualização. A figura \ref{fig:Mosaico1} mostra a distribuição dos módulos sobre as duas camadas da rede para diferentes valores de $\omega$ e $\gamma$.

```{=tex}
\begin{figure}[h!]
    \centering
    \includegraphics[width=1\textwidth]{./Figuras/Mosaico_edit.png}
    \caption{Módulos formados usando diferentes valores de acoplamento $\omega$ e resolução $\gamma$. Valores de $\omega$ variam no eixo y e valores de $\gamma$ variam no eixo x.}
    \label{fig:Mosaico1}
\end{figure}
```
\pagebreak

Quanto maiores o os valores de $\gamma$ e menores os valores de $\omega$, menores e mais numerosos são os módulos e vice-versa. A figura \ref{fig:Mosaico2} mostra o número de módulos para a rede Famílias de Florença, onde podemos ver que ocorre o previsto na teoria.

```{=tex}
\begin{figure}[h!]
    \centering
    \includegraphics[width=1\textwidth]{./Figuras/Mosaico_numero_de_modulos_edit.png}
    \caption{Número de módulos totais da rede para diferentes valores de acoplamento $\omega$ e resolução $\gamma$. Valores de $\omega$ variam no eixo y e valores de $\gamma$ variam no eixo x.}
    \label{fig:Mosaico2}
\end{figure}
```
\pagebreak

Mas, afinal, quais valores deveriam ser escolhidos para esses dois parâmetros? A resposta mais correta é: depende. Depende de qual propriedade da rede queremos enfocar e qual pergunta queremos responder com esse enfoque. Por exemplo, se quisermos verificar quais são os "grandes módulos" da rede, devemos usar um valor de $\gamma$ mais baixo, mas se quisermos olhar para os módulos menores (mais "íntimos") ou submódulos dos "grandes módulos" obtidos com um $\gamma$ mais baixo, um $\gamma$ maior seria mais indicado.

Se quisermos que as conexões de uma camada influenciem mais a outra camada, devemos usar um $\omega$ mais alto, caso contrário, melhor seria usar um $\omega$ mais baixo. Vamos usar agora como exemplo uma de rede interações entre morcegos e plantas ("rede Morcego-Planta", @Mello2019), onde existem duas camadas: uma de nectarivoria (consumo de néctar) e outra de frugivoria (consumo de frutos).

Se quisermos encontrar módulos onde existam morcegos com dietas mais similares entre si, um $\omega$ mais alto é recomendado, pois a frugivoria e a nectarivoria ficam com alta influência uma sobre a outra no cálculo dos módulos. Já se quisermos separar os morcegos com uma preferência maior por flores, por frutos ou que tenham uma dieta equilibrada, podemos usar um $\omega$ menor. Assim, aumenta a tendência de os módulos se formarem pesando mais as interações dentro de cada camada da rede. Isso faz com que os morcegos estejam em grupos que priorizam mais a nectarivoria ou a frugivoria ou até mesmo que possuem interações equilibradas entre camadas (estão em dois grupos em camadas diferentes).

Estudando a formação desses módulos de morcegos com diferentes dietas, podemos jogar luz sobre vários fenômenos ecológicos e evolutivos. Por exemplo, podemos dar mais um passo no entendimento sobre como a morfologia funcional do crânio de um morcego afeta a sua dieta [@rossoni2017] e, consequentemente, o papel funcional que ele desempenha em seu habitat [@mello2014]. Até o momento, tem-se estudado papeís funcionais quase exclusivamente no contexto de um único tipo de interação [@garcía-callejas2017]. Contudo, na natureza, observamos que as espécies de animais vivem entre mundos, alternando entre interações mutualistas e antagonistas em cada um deles. E a definição desses mundos em si depende muito da escala espaço-temporal estudada.

Outra rede do mundo real que usaremos aqui descreve interações entre formigas e plantas ("rede Formiga-Planta", @Costa2016). Nessa outra rede multicamada, as formigas se relacionam com as plantas através de quatro tipos de consumo de recursos diferentes: néctar extrafloral, pólen/néctar, frutos e melado de trofobiontes. Além disso, também fazem visitas simples, sem consequências mensuráveis para a planta. Essas interações geram então cinco camadas na rede e têm diferentes consequências para a vida das plantas e sua aptidão [@rico-gray2007].

Como no caso dos morcegos, essa rede Formiga-Planta também representa um emaranhado de diferentes mundos, com diferentes pressões seletivas para as formigas. Para consumir os diferentes tipos de recursos que as plantas oferecem, elas precisam de adaptações morfológicas e fisiológicas específicas. Ter ou não ter uma ou mais dessas adaptações leva diferentes espécies de formigas a ocuparem diferentes módulos na rede [@Costa2016]. Uma análise de modularidade multicamada tem o potencial de entender melhor as relações entre esses módulos em diferentes escalas de organização da rede.

Independente da história natural do sistema de estudo, caso queiramos apenas obter uma distribuição de módulos confiável sem a necessidade de interpretação, podemos escolher um valor de $\omega$ e $\gamma$ que maximiza a modularidade. Os valores de $\omega$ e $\gamma$ que maximizam a modularidade diferem para cada rede. A figura \ref{fig:Mosaico3} mostra os valores da modularidade para diferentes valores de $\omega$ e $\gamma$ da rede exemplo Famílias de Florença.

```{=tex}
\begin{figure}[h!]
    \centering
    \includegraphics[width=1\textwidth]{./Figuras/Mosaico_modularidade_edit.png}
    \caption{Valor da modularidade para diferentes valores de acoplamento $\omega$ e resolução $\gamma$. Valores de $\omega$ variam no eixo y e valores de $\gamma$ variam no eixo x.}
    \label{fig:Mosaico3}
\end{figure}
```
Com a resolução do ensaio feito, os valores mais indicados para a rede Famílias de Florença seriam $\omega = 0.75$ e $\gamma = 1.5$. Para valores mais precisos, basta aumentar as partições de $\gamma$ e $\omega$ ou refinar os valores de $\gamma$ e $\omega$ em torno dos máximos obtidos no ensaio anterior.

Também existe a possibilidade de que os valores de modularidade fiquem muito próximos uns dos outros. Nesse caso, é comum que os módulos fiquem muito similares entre si, então, é possível escolher qualquer um dos valores de $\omega$ e $\gamma$. Caso os módulos fiquem muito diferentes entre si (um caso mais raro), uma interpretação de um especialista na área que a rede está retratando é fundamental.

\clearpage

# Variável $G$ e $G_{norm}$

## Variável G

A variável G representa o número de módulos a que um determinado nó pertence. Como o algoritmo Louvain não permite que um mesmo nó participe de mais de um módulo dentro de uma mesma camada, G é uma variável discreta inteira que possui o mínimo de 1 e o máximo igual ao número de camadas da rede estudada. G possui valores bem definidos nos extremos, se $\omega = 0 \Rightarrow G = 1$ e se $\omega = 0 \Rightarrow G = \text{ número total de camadas da rede}$. Entre estes valores de $\omega$ o comportamento de G é variado, mas tende a cair conforme a força de acoplamento $\omega$ aumenta. O comportamento do decaimento de G em relação a $\omega$ é diferente para cada nó da rede, alguns nós resistem e permanecem em mais de um módulo ao aumentarmos $\omega$, já outros rapidamente passam a pertencer a apenas um módulo ao aumentarmos $\omega$. A figura \ref{fig:Figura_G} ilustra o comportamento de diferentes nós ao aumentarmos $\omega$. A figura \ref{fig:Exemplo_decai} mostra um exemplo de curva de decaimento de G em relação a $\omega$.

```{=tex}
\begin{figure}[H] 
\centering
\includegraphics[width=0.8\textwidth]{./Figuras/Figura_G.png}
\caption{Esquema ilustrativo do que ocorre com alguns nós ao aumentarmos o parâmetro $\omega$. Para valores de $\omega$ baixos, vemos que os nós A e B estão em módulos diferentes em camadas diferentes. Ao aumentarmos a força de acoplamento $\omega$, o nó A passa a pertencer ao módulo verde tanto na camada superior como na camada inferior, já o nó B resiste e permanece no módulo azul na camada superior e no módulo verde na camada inferior. Se aumentarmos ainda mais a força de acoplamento $\omega$, em algum momento o nó B acaba cedendo e passa a pertencer a apenas um módulo nas duas camadas.}
\label{fig:Figura_G}
\end{figure}
```
```{=tex}
\begin{figure}[H] 
\centering
\setlength{\fboxsep}{0pt}%
\setlength{\fboxrule}{0.25pt}%
\fbox{\includegraphics[width=0.7\textwidth]{./Figuras/Exemplo_decai.png}}
\caption{Exemplo hipotético de decaimentos de G (módulos que o nó pertence em diferentes camadas) em relação ao parâmetro $\omega$ (constante de acoplamento) esperados. O nó representado pela cor vermelha possui um decaimento rápido de G, portanto, representa uma espécie pouco conectiva do ponto de vista da rede multicamada como um todo. O contrário ocorre com a espécie representada pelo nó azul.}
\label{fig:Exemplo_decai}
\end{figure}
```
Como o algoritmo Louvain não é determinístico (pode retornar diferentes resultados a cada compilação) e a variável G é inteira e discreta, para termos uma maior confiabilidade precisamos repetir o processo várias vezes para cada valor de $\omega$ e extrair uma média de G para cada nó. Assim o valor médio de G é dado por:

```{=tex}
\begin{equation} \label{eq:3}
    \overline{G_{\omega}} = \frac{1}{I} \sum_{i=1}^{I} G_{i}
\end{equation}
```
Onde $I$ se refere ao número de iterações.

Repetindo isso para diferentes valores de $\omega$, teremos uma curva de decaimento $\overline{G}$ por $\omega$.

Podemos agora repetir esse processo para diferentes valores de $\gamma$, assim vamos obter diferentes curvas $\overline{G}$ por $\omega$ para cada valor de $\gamma$.

## Variável G$_{norm}$

Para facilitar a classificação dos nós de acordo com sua curva $\overline{G}$ por $\omega$ por $\gamma$, toda a família de curvas será resumida em uma única variável para cada nó, normalizada pela média. Chamaremos essa variável de $G_{norm}$, definida na equação \ref{eq:4}.

```{=tex}
\begin{equation} \label{eq:4}
    G_{norm} = \frac{\sum_{j=1}^{P_2} \sum_{i = 1}^{P_1} \overline{G}_{i,j}}{\frac{1}{N} \sum_{k=1}^{N} \sum_{j=1}^{P_2} \sum_{i = 1}^{P_1} \overline{G}_{i,j,k}}
\end{equation}
```
Onde $P_1$, $P_2$ são o número de partições de $\omega$ e $\gamma$; $N$ é u número de nós na rede; $i$, $j$ são os índices de $\overline{G}$ dentro de $\omega$, $\gamma$; e $k$ é o índice do nó na rede (número de identificação do nó).

\pagebreak

```{r leitura_dos_dados_morcego}
load("./RDatas/bats.RData")
net_name = "Morcego-Planta"
```

<!-- modifcar o 'net_x' para corresponder com as figuras -->

# Visão geral da rede `r net_name`

<!-- Usa as variaveis nodes e links para gerar a tabela comk os numeros da rede -->

```{r Propriedades_Rede}

net_multinet = Convert_to_Multinet(nodes, links)

lnum = num_layers_ml(net_multinet) #numero de camadas da rede

# serve para juntar toas as camadas em uma string soh. Bom para usar como texto
lnames = layers_ml(net_multinet)
lnames2 = ""
for (i in 1:lnum) {
  if (i==1) {
    lnames2 = paste(lnames[i])
  }
  else if (i==lnum) {
    lnames2 = paste(lnames2, " e ", lnames[i])
  }
  else{
    lnames2 = paste(lnames2, ", ", lnames[i])
  }
}

nnum = num_actors_ml(net_multinet, layers = character(0))

cnum = num_edges_ml(net_multinet)

#Monta a coluna de valores e nome da propriedade para montar o df propriedades_da_rede
numbers = c(lnum, lnames2, nnum, cnum)

labels = c("Número de Camadas", "Tipo de conexões", "Número de nós", "Número de conexões")

#Monta a tabela de prorpiedades da rede
propriedades_rede = data.frame(labels, numbers)
names(propriedades_rede) = c("Propriedade", "Valor")

```

<!-- Usa as variavei geradas no code chunk acima para preencher o texto -->

A rede `r net_name` [@`r bib_ref`] possui `r lnum` camadas (`r lnames2`), `r nnum` nós e `r cnum` conexões. A tabela \ref{tab:1} mostra o resumo das propriedades da rede. A figura \ref{fig:fig1} apresenta uma visão geral da rede.

```{r Tabela_Prop_Rede, col.names = NULL}
kable(propriedades_rede, "latex", booktabs = T, caption = paste("\\label{tab:1}Propriedades da rede ", net_name)) %>% kable_styling(latex_options = c("striped", "hold_position"))
```

<!-- links, nodes e layout sao variaveis vindas do .RData -->

```{r Figura_Overview, fig.cap=paste(fig.cap="\\label{fig:fig1}Visão geral da rede ", net_name, ".")}
#calcula um layout (igraph) e plota o grafo usando a funcao aux CustomPlot----
Custom_plot2D(links, nodes, layout, vertex_label_cex = NULL, vertex_size = 3) # TODO: melhorar o custom plot depois
```

<!-- Resultados da rede Morcego-Planta -->

# Resultados da rede `r net_name`

<!--# É melhor separar os resultados para animais e plantas. Isso facilita muito a interpretação biológica -->

## Distribuição de $\mathbf{G_{norm}}$

A variável $G$ foi calculada para `r partitions_of_omega` partições de $\omega$, ou seja, o tamanho do passo dado dentro de $\omega$ foi de `r 1/partitions_of_omega`. O processo foi repetido para `r length(gammas)` partições de $\gamma$, com $\gamma$ começando em `r min(gammas)`, com passos de `r (gammas[2] - gammas[1])` até um $\gamma$ máximo de `r max(gammas)`. O cálculo de $\overline{G}$ foi feito usando `r iterations` iterações. A tabela \ref{tab:2} resume os parâmetros de execução do código e a figura \ref{fig:fig2} mostra a distribuição dos valores de $G_{norm}$ obtidos.

```{r Parametros_Execucao}
numbers = c(iterations, partitions_of_omega)

labels = c("Iterações", "Partições de omega")

propriedades_rede = data.frame(labels, numbers)
names(propriedades_rede) = c("Parâmetro", "Valor")
kable(propriedades_rede, "latex", booktabs = T, caption = "\\label{tab:2}Parâmetros de execucao") %>% kable_styling(latex_options = c("striped", "hold_position"))
```

```{r Distribuicao_Gnorm, fig.cap=paste(fig.cap="\\label{fig:fig2}Distribuição de $G_{norm}$ médio da rede ", net_name, ".")}
G_norm_dristrib_plot(G_norm_mean_ordered)
```

## Variação de $\mathbf{\overline{G}}$ por $\boldsymbol{\omega}$

Como temos dados em 3 dimensões ($\overline{G}$, $\omega$, $\gamma$) temos diferentes possibilidades para apresentar os valores de $\overline{G}$ em relação a $\omega$ e $\gamma$. A figura \ref{fig:1a} mostra curvas de decaimento de $\overline{G}$ por $\omega$ para diferentes nós com diferentes valores de $G_{norm}$ e para diferentes valores de $\gamma$. A figura \ref{fig:1a.1} mostra a superfície 3D formada por $\overline{G}$ em relação a $\omega$ e $\gamma$. A figura \ref{fig:1a.2} mostra a mesma superfície da figura \ref{fig:1a.1} mas no formato de mapa de calor.

```{r select_exemple_nodes}
#seleciona quatro noh e guarda suas curvas de decaimento G em relacao a w e gamma usando funcao auxiliar
selection = Select_Example_Nodes(G_norm_mean_ordered)
plots_2D = list() #armazena os plots 2D que serao plotados
for (i in 1:length(selection)) {
  #plota a familia de curvas G para cada gamma de um no escolhido----
  chosen_node = names(selection[i])
  plots_2D[[i]] = G_curves_for_different_gammas(seq_Gnorm_gamma_mean, chosen_node, vec_W, gammas)
}
```

```{r decaimentos_ilustrativos, echo = FALSE, fig.cap=paste(fig.cap="\\label{fig:1a}Exemplos de curvas do decaimento de $\\overline{G}$ em relação a $\\omega$ e $\\gamma$ para diferentes valores de $\\gamma$ da rede ", net_name, ". (a) Curvas de $\\overline{G}$ da especie com maior valor de $G_{norm}$ da rede. (b) Segundo maior valor de $G_{norm}$. (c) Valor de $G_{norm}$ mais proximo da média geral da rede. (d) Curvas de $\\overline{G}$ referente a uma espécie com valor de $G_{norm}$ abaixo da média da rede."), fig.subcap=c(paste(names(selection[1]),". $G_{norm} =$", format(round(selection[1], 3), nsmall = 3)), paste(names(selection[2]),". $G_{norm} =$", format(round(selection[2], 3), nsmall = 3)), paste(names(selection[3]),". $G_{norm} =$", format(round(selection[3], 3), nsmall = 3)), paste(names(selection[4]),". $G_{norm} =$", format(round(selection[4], 3), nsmall = 3))), out.width='.49\\linewidth', fig.asp=1, fig.ncol = 2, fig.nrow = 2}

for (i in 1:length(selection)) {
  print(plots_2D[[i]])
}
```

```{r decaimentos_ilustrativos_sup_3D, echo = FALSE, fig.cap=paste(fig.cap="\\label{fig:1a.1}Exemplos de superfícies do decaimento de $\\overline{G}$ em relação a $\\omega$ e $\\gamma$ para diferentes valores de $\\gamma$ da rede ", net_name, ". (a) Superfície de $\\overline{G}$ da especie com maior valor de $G_{norm}$ da rede. (b) Segundo maior valor de $G_{norm}$. (c) Valor de $G_{norm}$ mais proximo da média geral da rede. (d) Superfície de $\\overline{G}$ referente a uma espécie com valor de $G_{norm}$ abaixo da média da rede."), fig.subcap=c(paste(names(selection[1]),". $G_{norm} =$", format(round(selection[1], 3), nsmall = 3)), paste(names(selection[2]),". $G_{norm} =$", format(round(selection[2], 3), nsmall = 3)), paste(names(selection[3]),". $G_{norm} =$", format(round(selection[3], 3), nsmall = 3)), paste(names(selection[4]),". $G_{norm} =$", format(round(selection[4], 3), nsmall = 3))), out.width='.49\\linewidth', fig.asp=1, fig.ncol = 2, fig.nrow = 2}

for (i in 1:length(selection)) {
  chosen_node = names(selection[i])
  Plot_G_gamma_omega_suf_3D(seq_Gnorm_gamma_mean, chosen_node, vec_W, gammas)
}
```

```{r decaimentos_ilustrativos_heatmap, echo = FALSE, fig.cap=paste(fig.cap="\\label{fig:1a.2}Exemplos de mapas de calor do decaimento de $\\overline{G}$ em relação a $\\omega$ e $\\gamma$ para diferentes valores de $\\gamma$ da rede ", net_name, ". (a) Mapa de calor de $\\overline{G}$ da especie com maior valor de $G_{norm}$ da rede. (b) Segundo maior valor de $G_{norm}$. (c) Valor de $G_{norm}$ mais proximo da média geral da rede. (d) Mapa de calor de $\\overline{G}$ referente a uma espécie com valor de $G_{norm}$ abaixo da média da rede."), fig.subcap=c(paste(names(selection[1]),". $G_{norm} =$", format(round(selection[1], 3), nsmall = 3)), paste(names(selection[2]),". $G_{norm} =$", format(round(selection[2], 3), nsmall = 3)), paste(names(selection[3]),". $G_{norm} =$", format(round(selection[3], 3), nsmall = 3)), paste(names(selection[4]),". $G_{norm} =$", format(round(selection[4], 3), nsmall = 3))), out.width='.49\\linewidth', fig.asp=1, fig.ncol = 2, fig.nrow = 2}

for (i in 1:length(selection)) {
  chosen_node = names(selection[i])
  Plot_G_gamma_omega_heat_3D(seq_Gnorm_gamma_mean, chosen_node, vec_W, gammas)
}
```

## Seleção das espécies com maior $\mathbf{G_{norm}}$.

```{r define_Gnorm_treshold}
G_threshold = 1.35
size1 = 3 #tamanho dos nos abixo do G_threshold
size2 = 3*size1 #tamanho dos valores acima de G_threshold

```

A figura \ref{fig:2a} e a tabela \ref{tab:3} mostram as espécies com valor de $G_{norm}$ acima de `r G_threshold`, ou seja, aquelas com decaimento de $G$ mais lento da rede `r net_name`. Os nomes das espécies de morcegos e plantas são apresentados em códigos e a relação entre o código e o nome científico pode ser consultado no Anexo I.

```{r define_aspecto}
if (lnum < 4) {
  asp = 0.6
}else{
  asp = 1
}
```

```{r fig-sub2, echo = FALSE, fig.cap=paste(fig.cap="\\label{fig:2a}Espécies com G$_{norm}$ maiores que ", G_threshold, "em destaque de tamanho e cor."), fig.asp=asp, nrow = 1, ncol = 3}

Custom_plot2D_destaque_palette(G_norm_mean, links, nodes, layout, size1, size2)

```

<!--
```{r, tabela_decimento_lento}
selected_nodes = sort(G_norm_mean[which(G_norm_mean > G_threshold)], decreasing = TRUE)
selected_nodes_df = data.frame(names(selected_nodes), format(round(selected_nodes, 3), nsmall = 3))
names(selected_nodes_df) = c("Espécie", "$G_{norm}$")
rownames(selected_nodes_df) = NULL

kable(selected_nodes_df, "latex", booktabs = T, caption = paste("\\label{tab:3}Espécies com valores de $G_{norm}$ maiores que", G_threshold), escape = FALSE) %>% kable_styling(latex_options = c("striped", "hold_position"))
```
-->

```{=tex}
\begin{table}[!ht]
\caption{Espécies com valores de $G_{norm}$ maiores que 1.35.}
\label{tab:3}
\centering
\begin{tabular}{cc|cc}
\hline
\multicolumn{2}{c|}{Morcegos} & \multicolumn{2}{c}{Plantas} \\
\hline
Espécie       & Gnorm       & Espécie       & Gnorm      \\
\hline
\hline
Artjam        & 1.548       & Syzjam        & 1.538      \\
Artlit        & 1.509       & Ingver        & 1.432      \\
Urobil        & 1.488       & Cecpel        & 1.401      \\
Stulil        & 1.469       & Manzap        & 1.360      \\
Carcas        & 1.401       &               &            \\
Carbre        & 1.392       &               &            \\
Artcon        & 1.391       &               &            \\
Vamnym        & 1.365       &               &            \\
Carper        & 1.364       &               &            \\
Plahel        & 1.359       &               &            \\
\hline
\end{tabular}
\end{table}
```


\pagebreak

```{r leitura_dos_dados_formigas}
load("./RDatas/ants.RData")
net_name = "Formiga-Planta"
```

<!-- modifcar o 'net_x' para corresponder com as figuras -->

# Visão geral da rede `r net_name`

<!-- Usa as variaveis nodes e links para gerar a tabela comk os numeros da rede -->

```{r Propriedades_Rede_b}

net_multinet = Convert_to_Multinet(nodes, links)

lnum = num_layers_ml(net_multinet) #numero de camadas da rede

# serve para juntar toas as camadas em uma string soh. Bom para usar como texto
lnames = layers_ml(net_multinet)
lnames2 = ""
for (i in 1:lnum) {
  if (i==1) {
    lnames2 = paste(lnames[i])
  }
  else if (i==lnum) {
    lnames2 = paste(lnames2, " e ", lnames[i])
  }
  else{
    lnames2 = paste(lnames2, ", ", lnames[i])
  }
}

nnum = num_actors_ml(net_multinet, layers = character(0))

cnum = num_edges_ml(net_multinet)

#Monta a coluna de valores e nome da propriedade para montar o df propriedades_da_rede
numbers = c(lnum, lnames2, nnum, cnum)

labels = c("Número de Camadas", "Tipo de conexões", "Número de nós", "Número de conexões")

#Monta a tabela de prorpiedades da rede
propriedades_rede = data.frame(labels, numbers)
names(propriedades_rede) = c("Propriedade", "Valor")

```

<!-- Usa as variavei geradas no code chunk acima para preencher o texto -->

A rede `r net_name` [@`r bib_ref`] possui `r lnum` camadas (`r lnames2`), `r nnum` nós e `r cnum` conexões. A tabela \ref{tab:1a} mostra o resumo das propriedades da rede. A figura \ref{fig:fig1a} apresenta uma visão geral da rede.

```{r Tabela_Prop_Rede_b, col.names = NULL}
kable(propriedades_rede, "latex", booktabs = T, caption = paste("\\label{tab:1a}Propriedades da rede ", net_name)) %>% kable_styling(latex_options = c("striped", "hold_position"))
```

<!-- links, nodes e layout sao variaveis vindas do .RData -->

```{r Figura_Overview_b, fig.cap=paste(fig.cap="\\label{fig:fig1a}Visão geral da rede ", net_name, ".")}
#calcula um layout (igraph) e plota o grafo usando a funcao aux CustomPlot----
Custom_plot2D(links, nodes, layout, vertex_label_cex = NULL, vertex_size = 3) # TODO: melhorar o custom plot depois
```

# Resultados da rede `r net_name`

<!--# É melhor separar os resultados para animais e plantas. Isso facilita muito a interpretação biológica -->

## Distribuição de $\mathbf{G_{norm}}$

A variável $G$ foi calculada para `r partitions_of_omega` partições de $\omega$, ou seja, o tamanho do passo dado dentro de $\omega$ foi de `r 1/partitions_of_omega`. O processo foi repetido para `r length(gammas)` partições de $\gamma$, com $\gamma$ começando em `r min(gammas)`, com passos de `r (gammas[2] - gammas[3])` até um $\gamma$ máximo de `r max(gammas)`. O cálculo de $\overline{G}$ foi feito usando `r iterations` iterações. A tabela \ref{tab:2a} resume os parâmetros de execução do código e a figura \ref{fig:fig2a} mostra a distribuição dos valores de $G_{norm}$ médio obtidos.

```{r Parametros_Execucao_b}
numbers = c(iterations, partitions_of_omega)

labels = c("Iterações", "Partições de omega")

propriedades_rede = data.frame(labels, numbers)
names(propriedades_rede) = c("Parâmetro", "Valor")
kable(propriedades_rede, "latex", booktabs = T, caption = "\\label{tab:2a}Parâmetros de execucao") %>% kable_styling(latex_options = c("striped", "hold_position"))
```

```{r Distribuicao_Gnorm_b, fig.cap=paste(fig.cap="\\label{fig:fig2a}Distribuição de $G_{norm}$ médio da rede ", net_name, ".")}
G_norm_dristrib_plot(G_norm_mean_ordered)
```

## Variação de $\mathbf{\overline{G}}$ por $\boldsymbol{\omega}$

Como temos dados em 3 dimensões ($\overline{G}$, $\omega$, $\gamma$) temos algumas formas diferentes para apresentar os valores de $\overline{G}$ em relação a $\omega$ e $\gamma$, não sei dizer se devemos usar uma delas, as três ou alguma outra. A figura \ref{fig:1b} mostra curvas de decaimento de $\overline{G}$ por $\omega$ para diferentes nós com diferentes valores de $G_{norm}$ e para diferentes valores de $\gamma$. A figura \ref{fig:1b.1} mostra a superfície 3D formada por $\overline{G}$ em relação a $\omega$ e $\gamma$. A figura \ref{fig:1b.2} mostra a mesma superfície da figura \ref{fig:1b.1} mas no formato de mapa de calor.

```{r select_exemple_nodes_b}
#seleciona quatro noh e guarda suas curvas de decaimento G em relacao a w e gamma usando funcao auxiliar
selection = Select_Example_Nodes(G_norm_mean_ordered)
plots_2D = list() #armazena os plots 2D que serao plotados
for (i in 1:length(selection)) {
  #plota a familia de curvas G para cada gamma de um no escolhido----
  chosen_node = names(selection[i])
  plots_2D[[i]] = G_curves_for_different_gammas(seq_Gnorm_gamma_mean, chosen_node, vec_W, gammas)
}
```

```{r decaimentos_ilustrativos_b, echo = FALSE, fig.cap=paste(fig.cap="\\label{fig:1b}Exemplos de curvas do decaimento de $\\overline{G}$ em relação a $\\omega$ e $\\gamma$ para diferentes valores de $\\gamma$ da rede ", net_name, ". (a) Curvas de $\\overline{G}$ da especie com maior valor de $G_{norm}$ da rede. (b) Segundo maior valor de $G_{norm}$. (c) Valor de $G_{norm}$ mais proximo da média geral da rede. (d) Curvas de $\\overline{G}$ referente a uma espécie com valor de $G_{norm}$ abaixo da média da rede."), fig.subcap=c(paste(names(selection[1]),". $G_{norm} =$", format(round(selection[1], 3), nsmall = 3)), paste(names(selection[2]),". $G_{norm} =$", format(round(selection[2], 3), nsmall = 3)), paste(names(selection[3]),". $G_{norm} =$", format(round(selection[3], 3), nsmall = 3)), paste(names(selection[4]),". $G_{norm} =$", format(round(selection[4], 3), nsmall = 3))), out.width='.49\\linewidth', fig.asp=1, fig.ncol = 2, fig.nrow = 2}

for (i in 1:length(selection)) {
  print(plots_2D[[i]])
}
```

```{r decaimentos_ilustrativos_sup_3D_b, echo = FALSE, fig.cap=paste(fig.cap="\\label{fig:1b.1}Exemplos de superfícies do decaimento de $\\overline{G}$ em relação a $\\omega$ e $\\gamma$ para diferentes valores de $\\gamma$ da rede ", net_name, ". (a) Superfície de $\\overline{G}$ da especie com maior valor de $G_{norm}$ da rede. (b) Segundo maior valor de $G_{norm}$. (c) Valor de $G_{norm}$ mais proximo da média geral da rede. (d) Superfície de $\\overline{G}$ referente a uma espécie com valor de $G_{norm}$ abaixo da média da rede."), fig.subcap=c(paste(names(selection[1]),". $G_{norm} =$", format(round(selection[1], 3), nsmall = 3)), paste(names(selection[2]),". $G_{norm} =$", format(round(selection[2], 3), nsmall = 3)), paste(names(selection[3]),". $G_{norm} =$", format(round(selection[3], 3), nsmall = 3)), paste(names(selection[4]),". $G_{norm} =$", format(round(selection[4], 3), nsmall = 3))), out.width='.49\\linewidth', fig.asp=1, fig.ncol = 2, fig.nrow = 2}

for (i in 1:length(selection)) {
  chosen_node = names(selection[i])
  Plot_G_gamma_omega_suf_3D(seq_Gnorm_gamma_mean, chosen_node, vec_W, gammas)
}
```

```{r decaimentos_ilustrativos_heatmap_b, echo = FALSE, fig.cap=paste(fig.cap="\\label{fig:1b.2}Exemplos de mapas de calor do decaimento de $\\overline{G}$ em relação a $\\omega$ e $\\gamma$ para diferentes valores de $\\gamma$ da rede ", net_name, ". (a) Mapa de calor de $\\overline{G}$ da especie com maior valor de $G_{norm}$ da rede. (b) Segundo maior valor de $G_{norm}$. (c) Valor de $G_{norm}$ mais proximo da média geral da rede. (d) Mapa de calor de $\\overline{G}$ referente a uma espécie com valor de $G_{norm}$ abaixo da média da rede."), fig.subcap=c(paste(names(selection[1]),". $G_{norm} =$", format(round(selection[1], 3), nsmall = 3)), paste(names(selection[2]),". $G_{norm} =$", format(round(selection[2], 3), nsmall = 3)), paste(names(selection[3]),". $G_{norm} =$", format(round(selection[3], 3), nsmall = 3)), paste(names(selection[4]),". $G_{norm} =$", format(round(selection[4], 3), nsmall = 3))), out.width='.49\\linewidth', fig.asp=1, fig.ncol = 2, fig.nrow = 2}

for (i in 1:length(selection)) {
  chosen_node = names(selection[i])
  Plot_G_gamma_omega_heat_3D(seq_Gnorm_gamma_mean, chosen_node, vec_W, gammas)
}
```

## Seleção das espécies com maior $\mathbf{G_{norm}}$.

```{r define_Gnorm_treshold_b}
G_threshold = 1.15
size1 = 3 #tamanho dos nos abixo do G_threshold
size2 = 4*size1 #tamanho dos valores acima de G_threshold

```

A figura \ref{fig:2b} e a tabela \ref{tab:3a} mostram as espécies com valor de $G_{norm}$ acima de `r G_threshold`, ou seja, aquelas com decaimento de $G$ mais lento da rede `r net_name`. Os nomes das espécies de formigas e plantas são apresentados em códigos e a relação entre o código e o nome científico pode ser consultado no Anexo II.

```{r define_aspecto_b}
if (lnum < 4) {
  asp = 0.6
}else{
  asp = 1
}
```

```{r fig-sub2_b, echo = FALSE, fig.cap=paste(fig.cap="\\label{fig:2b}Espécies com G$_{norm}$ maiores que ", G_threshold, "em destaque de tamanho e cor."), fig.asp=asp, nrow = 1, ncol = 3}

Custom_plot2D_destaque_palette(G_norm_mean, links, nodes, layout, size1, size2)

```
<!--
```{r, tabela_decimento_lento_b}
selected_nodes = sort(G_norm_mean[which(G_norm_mean > G_threshold)], decreasing = TRUE)
selected_nodes_df = data.frame(names(selected_nodes), format(round(selected_nodes, 3), nsmall = 3))
names(selected_nodes_df) = c("Espécie", "$G_{norm}$")
rownames(selected_nodes_df) = NULL

kable(selected_nodes_df, "latex", booktabs = T, caption = paste("\\label{tab:3a}Espécies com valores de $G_{norm}$ maiores que", G_threshold), escape = FALSE) %>% kable_styling(latex_options = c("striped", "hold_position"))
```
-->

```{=tex}
\begin{table}[!ht]
\caption{Espécies com valores de $G_{norm}$ maiores que 1.15.}
\label{tab:3a}
\centering
\begin{tabular}{cc|cc}
\hline
\multicolumn{2}{c|}{Formiga} & \multicolumn{2}{c}{Planta} \\
\hline
Espécie       & Gnorm       & Espécie       & Gnorm      \\
\hline
\hline
Camcra        & 1.355       & Baccon       & 1.386       \\
Brapic        & 1.341       & Vocthy       & 1.235       \\
Ceppus        & 1.222       & Remfer       & 1.189       \\
Camley        & 1.200       & Byrsp1       & 1.181       \\
Dorgoe        & 1.192       &              &             \\
Brasp1        & 1.153       &              &             \\
\hline
\end{tabular}
\end{table}
```
\vfill
\pagebreak


# Distribuição de $\mathbf{G_{norm}}$ para redes aleatórias

A distribuição dos valores de $G_{norm}$ também foi testada para algumas redes binárias puramente aleatórias, variando o número de camadas, conexões totais e nós. O universo de redes analisadas é apresentado na tabela \ref{table:univ_redes_aleat}. Foram geradas 10 redes aleatórias para cada combinação de camadas, conexões e nós, um total de 180 redes aleatórias foram analisadas.

```{=tex}
\begin{table}[!ht]
\caption{Universo de redes aleatórias analisadas. Foram geradas e analisadas dez amostras de cada uma das combinações de camada, conexões e nós.}
\label{table:univ_redes_aleat}
\centering
\begin{tabular}{ccc}
\hline
\textbf{Camadas} & \textbf{Conexões} & \textbf{Nós} \\
\hline
\hline
2 & 100 & 20 (20\% das conexões) \\
2 & 100 & 30 (30\% das conexões) \\
2 & 100 & 50 (50\% das conexões) \\
2 & 250 & 50 (20\% das conexões) \\
2 & 250 & 75 (30\% das conexões) \\
2 & 250 & 125 (50\% das conexões) \\
3 & 100 & 20 (20\% das conexões) \\
3 & 100 & 30 (30\% das conexões) \\
3 & 100 & 50 (50\% das conexões) \\
3 & 250 & 50 (20\% das conexões) \\
3 & 250 & 75 (30\% das conexões) \\
3 & 250 & 125 (50\% das conexões) \\
5 & 100 & 20 (20\% das conexões) \\
5 & 100 & 30 (30\% das conexões) \\
5 & 100 & 50 (50\% das conexões) \\
5 & 250 & 50 (20\% das conexões) \\
5 & 250 & 75 (30\% das conexões) \\
5 & 250 & 125 (50\% das conexões) \\
\hline
\end{tabular}
\end{table}
```
As figuras \ref{fig:hist_2cam}, \ref{fig:hist_3cam} e \ref{fig:hist_5cam} mostram as distribuições de Gnorm obtidas.

<!-- Inserir os histogramas de distribuição de Gnorm -->

```{r, histograma_2cam, echo = FALSE, fig.show = "hold", fig.cap=paste(fig.cap="\\label{fig:hist_2cam}Distribuição de $G_{norm}$ para o grupo de redes de duas camadas."), out.width='.45\\linewidth', fig.asp=1, fig.ncol = 2, fig.nrow = 3}

dir_to_plot = c("RDatas_2_100_20", "RDatas_2_250_50", "RDatas_2_100_30", "RDatas_2_250_75", "RDatas_2_100_50", "RDatas_2_250_125")
layers_set = c(2,2,2,2,2,2)
links_set = c(100, 250, 100, 250, 100, 250)
nodes_set = c(20, 50, 30, 75, 50, 125)
# par(mfrow=c(3, 3))
for (j in 1:length(dir_to_plot)) {
  
  # Gera uma lista com os caminhos dos RDatas do Gnorm
  rData_AllGnorm_path_list <- dir_ls(paste("./Analise_em_massa/", dir_to_plot[j], sep = ""), glob = "*.RData")

  load(rData_AllGnorm_path_list[[1]])
  allGnorm = G_norm_mean
  for (i in 2:length(rData_AllGnorm_path_list)) {
    load(rData_AllGnorm_path_list[[i]])
    allGnorm = append(allGnorm, G_norm_mean, after = length(allGnorm))
    allGnorm
  }

  plt = ggplot() + aes(allGnorm)+ geom_histogram(binwidth=0.1, colour="black", fill="#5195B8") +
  ggtitle(paste("Camadas = ", layers_set[j], " Conexões = ", links_set[j]," Nós = ", nodes_set[j], sep = "")) +
  #coord_cartesian(ylim = c(0,50)) +
  xlab("G") +
  labs(x=expression(G["norm"]), y=("Frequência")) +
  theme(axis.title.x = element_text(size = 18), axis.title.y = element_text(size = 18), plot.title = element_text(size = 22))
  plot(plt)
}

```

```{r, histograma_3cam, echo = FALSE, fig.show = "hold", fig.cap=paste(fig.cap="\\label{fig:hist_3cam}Distribuição de $G_{norm}$ para o grupo de redes de três camadas."), out.width='.45\\linewidth', fig.asp=1, fig.ncol = 2, fig.nrow = 3}

dir_to_plot = c("RDatas_3_100_20", "RDatas_3_250_50", "RDatas_3_100_30", "RDatas_3_250_75", "RDatas_3_100_50", "RDatas_3_250_125")
layers_set = c(3,3,3,3,3,3)
links_set = c(100, 250, 100, 250, 100, 250)
nodes_set = c(20, 50, 30, 75, 50, 125)
# par(mfrow=c(3, 3))
for (j in 1:length(dir_to_plot)) {
  
  # Gera uma lista com os caminhos dos RDatas do Gnorm
  rData_AllGnorm_path_list <- dir_ls(paste("./Analise_em_massa/", dir_to_plot[j], sep = ""), glob = "*.RData")

  load(rData_AllGnorm_path_list[[1]])
  allGnorm = G_norm_mean
  for (i in 2:length(rData_AllGnorm_path_list)) {
    load(rData_AllGnorm_path_list[[i]])
    allGnorm = append(allGnorm, G_norm_mean, after = length(allGnorm))
    allGnorm
  }

  plt = ggplot() + aes(allGnorm)+ geom_histogram(binwidth=0.1, colour="black", fill="#5195B8") +
  ggtitle(paste("Camadas = ", layers_set[j], " Conexões = ", links_set[j]," Nós = ", nodes_set[j], sep = "")) +
  #coord_cartesian(ylim = c(0,50)) +
  xlab("G") +
  labs(x=expression(G["norm"]), y=("Frequência")) +
  theme(axis.title.x = element_text(size = 18), axis.title.y = element_text(size = 18), plot.title = element_text(size = 22))
  plot(plt)
}

```

```{r, histograma_5cam, echo = FALSE, fig.show = "hold", fig.cap=paste(fig.cap="\\label{fig:hist_5cam}Distribuição de $G_{norm}$ para o grupo de redes de cinco camadas."), out.width='.45\\linewidth', fig.asp=1, fig.ncol = 2, fig.nrow = 3}

dir_to_plot = c("RDatas_5_100_20", "RDatas_5_250_50", "RDatas_5_100_30", "RDatas_5_250_75", "RDatas_5_100_50", "RDatas_5_250_125")
layers_set = c(5,5,5,5,5,5)
links_set = c(100, 250, 100, 250, 100, 250)
nodes_set = c(20, 50, 30, 75, 50, 125)
# par(mfrow=c(3, 3))
for (j in 1:length(dir_to_plot)) {
  
  # Gera uma lista com os caminhos dos RDatas do Gnorm
  rData_AllGnorm_path_list <- dir_ls(paste("./Analise_em_massa/", dir_to_plot[j], sep = ""), glob = "*.RData")

  load(rData_AllGnorm_path_list[[1]])
  allGnorm = G_norm_mean
  for (i in 2:length(rData_AllGnorm_path_list)) {
    load(rData_AllGnorm_path_list[[i]])
    allGnorm = append(allGnorm, G_norm_mean, after = length(allGnorm))
    allGnorm
  }

  plt = ggplot() + aes(allGnorm)+ geom_histogram(binwidth=0.1, colour="black", fill="#5195B8") +
  ggtitle(paste("Camadas = ", layers_set[j], " Conexões = ", links_set[j]," Nós = ", nodes_set[j], sep = "")) +
  #coord_cartesian(ylim = c(0,50)) +
  xlab("G") +
  labs(x=expression(G["norm"]), y=("Frequência")) +
  theme(axis.title.x = element_text(size = 18), axis.title.y = element_text(size = 18), plot.title = element_text(size = 22))
  plot(plt)
}

```

\pagebreak

# Comparação entre $\mathbf{G_{norm}}$ e outras métricas de centralidade para a rede agregada

Os nós que possuem maiores valores de $G_{norm}$ parecem ser os mais importantes dentro da rede. Isso porque, o fato de permanecerem em diferentes módulos em diferentes camadas, mesmo após o aumento do acoplamento, indica que eles se relacionam de maneira mais equilibrada com diferentes camadas. Assim, pode-se dizer que eles tem alto potencial como conectores entre diferentes módulos em diferentes camadas.

Esses nós mais importantes podem ser considerados como centrais, podendo ser conectores ou hubs [@Rodrigues2018]. Se compararmos os nós mais centrais de uma rede, identificados por outras métricas, com os nós que apresentaram maiores valores de $G_{norm}$, podemos examinar a relação entre diferentes métricas de centralidade.

Existem vários tipos de centralidade, calculadas usando-se diferentes parâmetros como base. Neste trabalho vamos comparar quatro dessas centralidades com os nós que possuem alto $G_{norm}$. São elas: \textit{Closeness} [@Sabidussi1966], \textit{Betweeness} [@Freeman1977], \textit{Eigen Vector} [@Bonacich1972] e \textit{Degree}. Estas centralidades são calculadas para a rede multicamada agregada.

Duas formas de comparação foram usadas. Uma se trata apenas de uma comparação binária, levando em conta apenas o número de nós em comum no topo dos rankings de $G_{norm}$ e das quatro outras centralides. Outra leva em conta a distância entre os rankings dos nós mais centrais para cada métrica.

A similaridade binária é bastante trivial e seu índice pode ser calculado da seguinte forma:

```{=tex}
\begin{equation} \label{eq:sim_bin}
Sim_{bin} = \frac{\sum_{j}^N\sum_{i}^N\delta(c_j, g_i)}{N}
\end{equation}
```
Onde $\delta(c_j, g_i)$ é o delta de Kronecker; $N$ é o ranking de corte escolhido (e.g $N=5$ no caso de escolhermos avaliar os cinco nós melhores ranqueados de cada métrica); $c_j$ e $g_i$ são os vetores ordenadas por ranking dos nós mais centrais e com maiores valores de $G_{norm}$ respectivamente. Os valores da similaridade variam entre 0 (nenhum nó em comum) e 1 (todos os nós em comum).

Além da comparação binária, podemos avaliar a similaridade levando em conta ranking do nó dentro do conjunto de corte escolhido. Para isso, adicionamos um fator de peso que é proporcional ao inverso da distância entre nós dentro da equação \ref{eq:sim_bin}.

```{=tex}
\begin{equation} \label{eq:sim_dist}
Sim_{dist} = \frac{\sum_{j}^{N}\sum_{i}^{N}\frac{1}{1+|i-j|}\delta(c_j, g_i)}{N}
\end{equation}
```
Onde o valor absoluto de $i-j$ é equivalente a distância entre os rankings dos nós $g_i$ e $c_j$. Os valores de $Sim_{dist}$ variam entre 0 e 1, onde 0 corresponde a nenhum nó em comum entre os métodos e 1 corresponde a todos os nós em comum e com o mesmo ranking.

Para comparar $G_{norm}$ com as centralidades de forma mais ampla, vamos analisar também os correlogramas entre $G_{norm}$ e das centralidades utilizando os métodos de Pearson e de Spearman.


## Comparação entre $\mathbf{G_{norm}}$ e outras métricas de centralidade para a rede Morcego-Planta

Comparando as 10 espécies de morcego mais bem ranqueadas pelas centralidades \textit{Closeness} , \textit{Betweeness} , \textit{Eigen Vector} e \textit{Degree} com as 10 mais bem ranqueadas segundo $G_{norm}$, vemos que existem 7 espécies que também estão presentes em ao menos uma das quatro outras centralidades avaliadas.

Três espécies que estão entre as 10 mais bem ranqueadas pelos valores de $G_{norm}$ não estão presentes em nenhuma das centralidades avaliadas. A tabela \ref{table:centr_raw_bats} mostra as 10 espécies melhores ranqueadas pelas centralidades e pelos valores $G_{norm}$, destacando as espécies em comum (negrito) e únicas do $G_{norm}$ (itálico).

```{=tex}
\begin{table}[!ht]
\caption{Nós ordenados de forma decrescente de acordo com seus valores de centralidade e $G_{norm}$ para os morcegos da rede de Morcego-Planta. Em negrito as espécies que alto valor de $G_{norm}$ e que também foram selecionadas por pelo menos uma métrica de centralidade. Em itálico as espécies que possuem alto valor de $G_{norm}$ mas não foram selecionadas em nenhuma outra centralidade.}\label{table:centr_raw_bats}
\footnotesize
\begin{tabular}{cc|cc|cc|cc|cc}
\hline
\multicolumn{2}{c|}{Closeness} & \multicolumn{2}{c|}{Betweeness} & \multicolumn{2}{c|}{Eigen Vector} & \multicolumn{2}{c|}{Degree} & \multicolumn{2}{c}{Gnorm} \\
\hline
\hline
\textbf{Artjam}        & 0.00082       & \textbf{Artjam}        & 0.30347        & \textbf{Artjam}         & 1.00000         & \textbf{Artjam}        & 149        & \textbf{Artjam}      & 1.54825     \\
\textbf{Carper}        & 0.00079       & \textbf{Carper}        & 0.26423        & \textbf{Carper}         & 0.86257         & \textbf{Carper}        & 138        & \textbf{Artlit}      & 1.50918     \\
\textbf{Artlit}        & 0.00076       & \textbf{Artlit}        & 0.15230        & \textbf{Artlit}         & 0.80165         & \textbf{Artlit}        & 112        & \textbf{\textbf{Urobil}}      & 1.48774     \\
Glosor        & 0.00071       & Glosor        & 0.14406        & \textbf{Stulil}         & 0.39613         & \textbf{Stulil}        & 72         & \textbf{Stulil}      & 1.46916     \\
\textbf{Stulil}        & 0.00070       & \textbf{Stulil}        & 0.13341        & Glosor         & 0.31185         & Glosor        & 65         & \textbf{Carcas}      & 1.40143     \\
Phyhas        & 0.00067       & Lepcur        & 0.08033        & \textbf{Carcas}         & 0.27444         & \textbf{Carcas}        & 44         & \textbf{Carbre}      & 1.39168     \\
Phydis        & 0.00066       & Anocau        & 0.06970        & Phyhas         & 0.25856         & Lepcur        & 43         & \textit{Artcon}      & 1.39080     \\
Lepcur        & 0.00065       & Stulud        & 0.05518        & \textbf{\textbf{Urobil}}         & 0.25543         & Phyhas        & 40         & \textit{Vamnym}      & 1.36506     \\
Glocom        & 0.00064       & Monred        & 0.04970        & Artpha         & 0.22331         & Anocau        & 30         & \textbf{Carper}      & 1.36363     \\
\textbf{Carcas}        & 0.00064       & Phyhas        & 0.04302        & \textbf{Carbre}         & 0.19272         & \textbf{Carbre}        & 29         & \textit{Plahel}      & 1.35870    \\
\hline
\end{tabular}
\end{table}
```

Comparando as 10 espécies de plantas mais bem ranqueadas pelas centralidades \textit{Closeness} , \textit{Betweeness} , \textit{Eigen Vector} e \textit{Degree} com as 10 mais bem ranqueadas segundo $G_{norm}$, vemos que existem 5 espécies que também estão presentes em ao menos uma das quatro outras centralidades avaliadas.

Cinco espécies que estão entre as 10 mais bem ranqueadas pelos valores de $G_{norm}$ não estão presentes em nenhuma das centralidades avaliadas. A tabela \ref{table:centr_raw_bats_plants} mostra as 10 espécies melhores ranqueadas pelas centralidades e pelos valores $G_{norm}$, destacando as espécies em comum (negrito) e únicas do $G_{norm}$ (itálico).

```{=tex}
\begin{table}[!ht]
\caption{Nós ordenados de forma decrescente de acordo com seus valores de centralidade e $G_{norm}$ para as plantas da rede de Morcego-Planta. Em negrito as espécies que alto valor de $G_{norm}$ e que também foram selecionadas por pelo menos uma métrica de centralidade. Em itálico as espécies que possuem alto valor de $G_{norm}$ mas não foram selecionadas em nenhuma outra centralidade.}
\label{table:centr_raw_bats_plants}
\footnotesize
\begin{tabular}{cc|cc|cc|cc|cc}
\hline
\multicolumn{2}{c|}{Closeness} & \multicolumn{2}{c|}{Betweeness} & \multicolumn{2}{c|}{Eigen Vector} & \multicolumn{2}{c|}{Degree} & \multicolumn{2}{c}{Gnorm} \\
\hline
\hline
Cecobt            & 0.000787   & Ceipen              & 0.0700    & \textbf{Cecpel}      & 0.368      & Cecobt              & 16    & \textbf{Syzjam}  & 1.538  \\
\textbf{Cecpel}   & 0.000767   & \textbf{Syzjam}     & 0.0554    & Cecobt               & 0.269      & Ficins              & 15    & \textit{Ingver}  & 1.432  \\
Mactin            & 0.000755   & Cecobt              & 0.0412    & \textbf{Manzap}      & 0.266      & Solrug              & 14    & \textbf{Cecpel}  & 1.400  \\
Manind            & 0.000746   & \textbf{Manzap}     & 0.0319    & Ficins               & 0.260      & \textbf{Cecpel}     & 13    & \textbf{Manzap}  & 1.360  \\
\textbf{Manzap}   & 0.000743   & \textbf{Cecpel}     & 0.0303    & Solrug               & 0.253      & Cecusa              & 13    & \textbf{Dysvir}  & 1.337  \\
Piparb            & 0.000740   & \textbf{Pacweb}     & 0.0220    & Cecfic               & 0.237      & Ceipen              & 13    & \textbf{Pacweb}  & 1.292  \\
Carpap            & 0.000737   & Pipama              & 0.0189    & Pipadu               & 0.229      & Ficyop              & 13    & \textit{Stegri}  & 1.227  \\
Pipama            & 0.000734   & \textbf{Dysvir}     & 0.0174    & Fictri               & 0.227      & \textbf{Manzap}     & 13    & \textit{Neotet}  & 1.224  \\
Cecgla            & 0.000729   & Spomom              & 0.0169    & Piparb               & 0.220      & Cecfic              & 12    & \textit{Broali}  & 1.220  \\
Muncal            & 0.000729   & Mactin              & 0.0166    & Ficobt               & 0.208      & Fictri              & 12    & \textit{Cerrep}  & 1.190  \\
\hline
\end{tabular}
\end{table}
```

A similaridade binária entre os 10 morcegos melhores ranqueados pelos valores de $G_{norm}$ e os 10 morcegos melhores ranqueados pelas centralidades avaliadas ficou entre 40% e 70%, ficando menos similar à centralidade \textit{Betweeness} e mais similar a centralidade \textit{Eigen Vector} (tabela \ref{table:centr_sim_bin_bats}).Levando em conta a distância entre os rankings para calcular a similaridade tivemos menor similaridade entre $G_{norm}$ e a centralidade \textit{Betweeness}, e uma maior similaridade às centralidades \textit{Eigen Vector} e \textit{Degree}, mas a similaridade nesse caso caiu bastante, mostrando que o ranqueamento entre $G_{norm}$ e as outras similaridades é diferente quando avaliamos os nós mais bem colocados (tabela \ref{table:centr_sim_dist_bats}).

A similaridade binária entre as 10 plantas melhores ranqueadas pelos valores de $G_{norm}$ e as 10 melhores ranqueadas pelas centralidades avaliadas ficou entre bem abaixo da observada apenas para os morcegos, ficando, no caso das plantas, entre 20% (*Closeness*, *Eigen Vector* e *Degree*) e 70% (*Betweeness*)(tabela \ref{table:centr_sim_bin_bats_plants}).Levando em conta a distância entre os rankings para calcular a similaridade tivemos uma diminuição dos valores, devido a diferença da ordem de ranqueamnto, mas manteve a proporcionalidade da similaridade binária (tabela \ref{table:centr_sim_dist_bats_plants}).

```{=tex}
\begin{table}[!ht]
\caption{Similaridade binária entre $G_{norm}$ e outras métricas de centralidade para os morcegos da rede de Morcego-Planta.}\label{table:centr_sim_bin_bats}
\centering
\begin{tabular}{cccc}
\hline
Closeness & Betweeness & Eigen Vector & Degree\\
\hline
\hline
 0.5 & 0.4 & 0.7 & 0.6\\
\hline
\end{tabular}
\end{table}
```


```{=tex}
\begin{table}[!ht]
\caption{Similaridade ponderada pela distância dos rankings entre $G_{norm}$ e outras métricas de centralidade para os morcegos da rede de Morcego-Planta.}\label{table:centr_sim_dist_bats}
\centering
\begin{tabular}{cccc}
\hline
Closeness & Betweeness & Eigen Vector & Degree \\
\hline
\hline
0.229 & 0.212 & 0.349 & 0.332 \\
\hline
\end{tabular}
\end{table}
```


```{=tex}
\begin{table}[!ht]
\caption{Similaridade binária entre $G_{norm}$ e outras métricas de centralidade para as plantas da rede de Morcego-Planta.}\label{table:centr_sim_bin_bats_plants}
\centering
\begin{tabular}{cccc}
\hline
Closeness & Betweeness & Eigen Vector & Degree\\
\hline
\hline
0.2 & 0.5 & 0.2 & 0.2\\
\hline
\end{tabular}
\end{table}
```


```{=tex}
\begin{table}[!ht]
\caption{Similaridade ponderada pela distância dos rankings entre $G_{norm}$ e outras métricas de centralidade para as plantas da rede de Morcego-Planta.}\label{table:centr_sim_dist_bats_plants}
\centering
\begin{tabular}{cccc}
\hline
Closeness & Betweeness & Eigen Vector & Degree \\
\hline
\hline
0.100 & 0.308 & 0.083 & 0.0700\\
\hline
\end{tabular}
\end{table}
```

Usando os correlogramas de Spearman e Pearson apenas para os morcegos (figuras \ref{fig:pearson_bats} e \ref{fig:spearman_bats}) e para as plantas da rede (figuras \ref{fig:pearson_bats_plants} e \ref{fig:spearman_bats_plants}), vemos que quando avaliamos apenas os morcegos, a correlação entre as centraliadades e $G_{norm}$ é média (entre 0.58 e 0.71) e homogênea entre as centralidades, ficando um pouco mais alta para o \textit{eigen vector} (0.71) no caso do método de Pearson (figura \ref{fig:pearson_bats}). Já quando avaliamos as plantas, temos uma queda na correlação, com exceção da centralidade *Betweeness* para o método de Pearson, onde a correlação ficou com um valor de 0.5.

```{=tex}
\begin{figure}[H] 
\centering
\includegraphics[width=0.7\textwidth]{./Figuras/centr_correlogram_bats_bats_pearson.png}
\caption{Correlograma comparando as centralidades com $G_{norm}$ utilizando o método de Pearson para os morcegos da rede Morcego-Planta}
\label{fig:pearson_bats}
\end{figure}
```
```{=tex}
\begin{figure}[H] 
\centering
\includegraphics[width=0.7\textwidth]{./Figuras/centr_correlogram_bats_bats_spearman.png}
\caption{Correlograma comparando as centralidades com $G_{norm}$ utilizando o método de Spearman para os morcegos da rede Morcego-Planta}
\label{fig:spearman_bats}
\end{figure}
```
```{=tex}
\begin{figure}[H] 
\centering
\includegraphics[width=0.7\textwidth]{./Figuras/centr_correlogram_bats_plants_pearson.png}
\caption{Correlograma comparando as centralidades com $G_{norm}$ utilizando o método de Pearson para as plantas da rede Morcego-Planta}
\label{fig:pearson_bats_plants}
\end{figure}
```
```{=tex}
\begin{figure}[H] 
\centering
\includegraphics[width=0.7\textwidth]{./Figuras/centr_correlogram_bats_plants_spearman.png}
\caption{Correlograma comparando as centralidades com $G_{norm}$ utilizando o método de Spearman para as plantas da rede Morcego-Planta}
\label{fig:spearman_bats_plants}
\end{figure}
```

## Comparação $\mathbf{G_{norm}}$ e outras métricas de centralidade para a rede Formiga-Planta

Comparando as 10 espécies de formigas mais bem ranqueadas pelas centralidades \textit{Closeness} , \textit{Betweeness} , \textit{Eigen Vector} e \textit{Degree} com as 10 mais bem ranqueadas por $G_{norm}$ vemos que existem 8 espécies que também estão presentes em ao menos uma das centralidades avaliadas.

Duas espécies que estão entre as 10 melhores ranqueadas pelos valores de $G_{norm}$ não estão presentes em nenhuma das centralidades avaliadas. A tabela \ref{table:centr_raw_ants} mostra as 10 espécies melhores ranqueadas pelas centralidades e pelos valores $G_{norm}$, destacando as espécies em comum (negrito) e únicas do $G_{norm}$ (itálico).

```{=tex}
\begin{table}[!ht]
\caption{Nós ordenados de forma decrescente de acordo com seus valores de centralidade e $G_{norm}$ para as formigas da rede de Formiga-Planta. Em negrito as espécies que alto valor de $G_{norm}$ e que também foram selecionadas por pelo menos uma métrica de centralidade. Em itálico as espécies que possuem alto valor de $G_{norm}$ mas não foram selecionadas em nenhuma outra centralidade.}\label{table:centr_raw_ants}
\footnotesize
\begin{tabular}{cc|cc|cc|cc|cc}
\hline
\multicolumn{2}{c|}{Closeness} & \multicolumn{2}{c|}{Betweeness} & \multicolumn{2}{c|}{Eigen Vector} & \multicolumn{2}{c|}{Degree} & \multicolumn{2}{c}{Gnorm} \\
\hline
\hline
\textbf{Cepus}    & 0.00520   & \textbf{Cepus}     & 0.53495   & \textbf{Cepus}      & 1.00000    & \textbf{Cepus}     & 294   & \textbf{Camcra} & 1.35486 \\
Camruf            & 0.00446   & \textbf{Bracor}    & 0.12861   & \textbf{Bracor}     & 0.31935    & \textbf{Bracor}    & 94    & \textbf{Brapic} & 1.34081 \\
\textbf{Bracor}   & 0.00423   & \textbf{Camcra}    & 0.12211   & Camruf              & 0.22994    & Camruf             & 81    & \textbf{Cepus}  & 1.22185 \\
\textbf{Camcra}   & 0.00409   & \textbf{Brapic}    & 0.08311   & \textbf{Camcra}     & 0.22196    & \textbf{Camcra}    & 80    & \textbf{Camley} & 1.20006 \\
\textbf{Brapic}   & 0.00390   & Camruf             & 0.07750   & \textbf{Brapic}     & 0.14228    & \textbf{Brapic}    & 45    & \textit{Dorgoe} & 1.19244 \\
\textbf{Psepal}   & 0.00387   & \textbf{Psepal}    & 0.04944   & \textbf{Psepal}     & 0.12515    & \textbf{Psepal}    & 41    & \textit{Brasp1} & 1.15256 \\
Camtra            & 0.00378   & Camtra             & 0.03318   & Camtra              & 0.12494    & Camtra             & 38    & \textbf{Phetri} & 1.13723 \\
Camwes            & 0.00347   & Cambla             & 0.01987   & Camwes              & 0.10575    & Camwes             & 23    & \textbf{Bracor} & 1.13674 \\
\textbf{Linmic}   & 0.00344   & Camley             & 0.01921   & \textbf{Phetri}     & 0.05029    & \textbf{Phetri}    & 15    & \textbf{Linmic} & 1.09468 \\
\textbf{Camley}   & 0.00340   & Ecttub             & 0.01908   & \textbf{Camley}     & 0.04375    & \textbf{Camley}    & 12    & \textbf{Psepal} & 1.08898\\
\hline
\end{tabular}
\end{table}
```


Comparando as 10 espécies de plantas mais bem ranqueadas pelas centralidades \textit{Closeness} , \textit{Betweeness} , \textit{Eigen Vector} e \textit{Degree} com as 10 mais bem ranqueadas segundo $G_{norm}$ vemos que existem 5 espécies que também estão presentes em ao menos uma das centralidades avaliadas. As outras cinco espécies que estão entre as 10 melhores ranqueadas pelos valores de $G_{norm}$ não estão presentes em nenhuma das centralidades avaliadas. A tabela \ref{table:centr_raw_ants_plants} mostra as 10 espécies melhores ranqueadas pelas centralidades e pelos valores $G_{norm}$, destacando as espécies em comum (negrito) e únicas do $G_{norm}$ (itálico).

A similaridade binária entre as 10 melhores plantas ranqueadas pelos valores de $G_{norm}$ e as 10 melhores ranqueadas pelas centralidades avaliadas ficaram muito próximas para todas as centralidades estudadas, entre 30% e 40% (tabela \ref{table:centr_sim_bin_ants_plants}).

Levando em conta a distância entre os rankings para calcular a similaridade, podemos ver que houve uma diminuição dos valores e uma maior diferenciação das similaridades entre $G_{norm}$ e as centralidades, com *Closeness* e *Degree* sendo os mais similares (tabela \ref{table:centr_sim_dist_ants_plants}).

```{=tex}
\begin{table}[!ht]
\caption{Nós ordenados de forma decrescente de acordo com seus valores de centralidade e $G_{norm}$ para as plantas da rede de Formiga-Planta. Em negrito as espécies que alto valor de $G_{norm}$ e que também foram selecionadas por pelo menos uma métrica de centralidade. Em itálico as espécies que possuem alto valor de $G_{norm}$ mas não foram selecionadas em nenhuma outra centralidade.}\label{table:centr_raw_ants_plants}
\footnotesize
\begin{tabular}{cc|cc|cc|cc|cc}
\hline
\multicolumn{2}{c|}{Closeness} & \multicolumn{2}{c|}{Betweeness} & \multicolumn{2}{c|}{Eigen Vector} & \multicolumn{2}{c|}{Degree} & \multicolumn{2}{c}{Gnorm} \\
\hline
\hline
\textbf{Baccon}   & 0.004424  & Symret             & 0.09794   & Chapap              & 0.4557     & Symret             & 60    & \textbf{Baccon}  & 1.3861 \\
Velniv            & 0.004424  & Velniv             & 0.07733   & Symret              & 0.4140     & Chapap             & 58    & \textit{Vocthy}  & 1.2351 \\
Barfla            & 0.004385  & Chapap             & 0.07007   & Barfla              & 0.3907     & \textbf{Baccon}    & 47    & \textit{Remfer}  & 1.1890 \\
Velcor            & 0.004385  & \textbf{Baccon}    & 0.06570   & \textbf{Baccon}     & 0.3341     & Velniv             & 47    & \textbf{Byrsp1}  & 1.1809 \\
Symret            & 0.004347  & \textbf{Myrmon}    & 0.06378   & \textbf{Myrmon}     & 0.3053     & Barfla             & 46    & \textit{Mikita}  & 1.1176 \\
Chapap            & 0.004273  & Barfla             & 0.06104   & \textbf{Byrsp1}     & 0.2544     & \textbf{Myrmon}    & 46    & \textbf{Aspjol}  & 1.0908 \\
\textbf{Myrmon}   & 0.004237  & Velcor             & 0.05767   & Velniv              & 0.2482     & Velcor             & 33    & \textbf{Myrmon}  & 1.0428 \\
\textbf{Byrsp1}   & 0.004201  & \textbf{Tetmic}    & 0.02613   & Crosp1              & 0.2426     & \textbf{Byrsp1}    & 31    & \textit{Dasret}  & 1.0371 \\
\textbf{Tetmic}   & 0.004201  & Crosp1             & 0.02532   & \textbf{Aspjol}     & 0.2211     & Crosp1             & 31    & \textit{Diporb}  & 1.0260 \\
Lycram            & 0.004065  & Peitom             & 0.02502   & Velcor              & 0.2077     & \textbf{Tetmic}    & 26    & \textbf{Tetmic}  & 1.0250 \\
\hline
\end{tabular}
\end{table}
```


```{=tex}
\begin{table}[!ht]
\caption{Similaridade binária entre $G_{norm}$ e outras métricas de centralidade para as formigas da rede de Formiga-Planta.}\label{table:centr_sim_bin_ants}
\centering
\begin{tabular}{cccc}
\hline
Closeness & Betweeness & Eigen Vector & Degree\\
\hline
\hline
0.7 & 0.6 & 0.7 & 0.7\\
\hline
\end{tabular}
\end{table}
```

```{=tex}
\begin{table}[!ht]
\caption{Similaridade ponderada pela distância dos rankings entre $G_{norm}$ e outras métricas de centralidade para as formigas da rede de Formiga-Planta.}\label{table:centr_sim_dist_ants}
\centering
\begin{tabular}{cccc}
\hline
Closeness & Betweeness & Eigen Vector & Degree \\
\hline
\hline
0.220 & 0.175 & 0.153 & 0.225\\
\hline
\end{tabular}
\end{table}
```


```{=tex}
\begin{table}[!ht]
\caption{Similaridade binária entre $G_{norm}$ e outras métricas de centralidade para as plantas da rede de Formiga-Planta.}\label{table:centr_sim_bin_ants_plants}
\centering
\begin{tabular}{cccc}
\hline
Closeness & Betweeness & Eigen Vector & Degree\\
\hline
\hline
0.4 & 0.3 & 0.4 & 0.4\\
\hline
\end{tabular}
\end{table}
```

```{=tex}
\begin{table}[!ht]
\caption{Similaridade ponderada pela distância dos rankings entre $G_{norm}$ e outras métricas de centralidade para as plantas da rede de Formiga-Planta.}\label{table:centr_sim_dist_ants_plants}
\centering
\begin{tabular}{cccc}
\hline
Closeness & Betweeness & Eigen Vector & Degree \\
\hline
\hline
0.270 & 0.091 & 0.116 & 0.203\\
\hline
\end{tabular}
\end{table}
```

Usando os correlogramas de Spearman e Pearson apenas para as formigas (figuras \ref{fig:pearson_ants} e \ref{fig:spearman_ants}) e para as plantas da rede (figuras \ref{fig:pearson_ants_plants} e \ref{fig:spearman_ants_plants}), vemos que quando avaliamos apenas as formigas, a correlação entre as centraliadades e $G_{norm}$ é média (entre 0.48 e 0.66) quando usamos o método de Pearson, ficando um pouco mais alta e homogênea (entre 0.78 e 0.82) para o método de Spearman. Já quando avaliamos a rede como um todo (plantas e formigas), temos uma queda na correlação, ficando entre 0.43 e 0.48 no método de Pearson e entre 0.49 e 0.66 quando utilizamos o método de Spearman. Quando avaliamos apenas as plantas, a correlação cai um pouco, mas ainda continua próxima do observado apenas para as formigas.

```{=tex}
\begin{figure}[H] 
\centering
\includegraphics[width=0.7\textwidth]{./Figuras/centr_correlogram_ants_ants_pearson.png}
\caption{Correlograma comparando as centralidades com $G_{norm}$ utilizando o método de Pearson para as formigas da rede Formiga-Planta}
\label{fig:pearson_ants}
\end{figure}
```
```{=tex}
\begin{figure}[H] 
\centering
\includegraphics[width=0.7\textwidth]{./Figuras/centr_correlogram_ants_ants_spearman.png}
\caption{Correlograma comparando as centralidades com $G_{norm}$ utilizando o método de Spearman para as formigas da rede Formiga-Planta}
\label{fig:spearman_ants}
\end{figure}
```
```{=tex}
\begin{figure}[H] 
\centering
\includegraphics[width=0.7\textwidth]{./Figuras/centr_correlogram_ants_plants_pearson.png}
\caption{Correlograma comparando as centralidades com $G_{norm}$ utilizando o método de Pearson para as plantas da rede Formiga-Planta}
\label{fig:pearson_ants_plants}
\end{figure}
```
```{=tex}
\begin{figure}[H] 
\centering
\includegraphics[width=0.7\textwidth]{./Figuras/centr_correlogram_ants_plants_spearman.png}
\caption{Correlograma comparando as centralidades com $G_{norm}$ utilizando o método de Spearman para as plantas da rede Formiga-Planta}
\label{fig:spearman_ants_plants}
\end{figure}
```
## Comparação entre $\mathbf{G_{norm}}$ e outras métricas de centralidade para as redes aleatórias

As tabelas \ref{table:centr_sim_bin_rand} e \ref{table:centr_sim_dist_rand} mostram a comparação de similaridade binária e de distância entre os nós centrais e com alto G$_{norm}$ para todo o grupo de redes aleatórias estudadas (tabela \ref{table:univ_redes_aleat}), considerando os 10 nós mais bem ranqueados. As figuras \ref{fig:pearson_rand_all} e \ref{fig:pearson_rand_all} mostram os correlogramas utilizando o método de Pearson e Spearman para as redes aleatórias.

Vemos que mesmo as redes sendo aleatórias, ainda existe uma certa similiaridade e correlação entre nós com alto $G_{norm}$ e as centralidades, apesar de haver variação. As similaridades e correlações não ficaram na mesma ordem que as avaliadas nas redes de Morcego-Planta e Formiga-Planta, diminuindo de valor.

```{=tex}
\begin{table}[!ht]
\caption{Similaridade binária entre $G_{norm}$ e outras métricas de centralidade para as redes aleatórias, considerando os 10 mais bem colocados de cada métrica.}\label{table:centr_sim_bin_rand}
\centering
\begin{tabular}{ccccc}
\hline
 & Closeness & Betweeness & Eigen Vector & Degree\\
\hline
\hline
Média & 0.327 & 0.327 & 0.290 & 0.309\\
sd & 0.203 & 0.209 & 0.208 & 0.207\\
\hline
\end{tabular}
\end{table}
```
```{=tex}
\begin{table}[!ht]
\caption{Similaridade ponderada pela distância dos rankings entre $G_{norm}$ e outras métricas de centralidade para as redes aleatórias, considerando os 10 mais bem colocados de cada métrica.}\label{table:centr_sim_dist_rand}
\centering
\begin{tabular}{ccccc}
\hline
 & Closeness & Betweeness & Eigen Vector & Degree\\
\hline
\hline
Média & 0.109 & 0.110 & 0.104 & 0.108\\
sd & 0.082 & 0.086 & 0.088 & 0.083\\
\hline
\end{tabular}
\end{table}
```
```{=tex}
\begin{figure}[H] 
\centering
\includegraphics[width=0.7\textwidth]{./Figuras/centr_correlogram_rand_all_pearson.png}
\caption{Correlograma comparando as centralidades com $G_{norm}$ utilizando o método de Pearson para as redes aleatórias.}
\label{fig:pearson_rand_all}
\end{figure}
```
```{=tex}
\begin{figure}[H] 
\centering
\includegraphics[width=0.7\textwidth]{./Figuras/centr_correlogram_rand_all_spearman.png}
\caption{Correlograma comparando as centralidades com $G_{norm}$ utilizando o método de Spearman para as redes aleatórias.}
\label{fig:spearman_rand_all}
\end{figure}
```
```{=tex}
\clearpage
\pagebreak
```
# Discussão

Os parâmetros $\omega$ e $\gamma$ usados para calcular a modularidade usando o método Louvain em redes *multiplex* abre novas possibilidades para o estudo de redes de interações. Isso porque, ao variarmos esses parâmetros, podemos identificar módulos diferentes, que variam de acordo com o quanto queremos que as camadas estejam acopladas e qual a resolução dos módulos queremos enfocar. Usando essas novas variáveis, podemos também identificar alguns nós especiais que permanecem em módulos diferentes em camadas diferentes, resistindo ao alto acoplamento entre as camadas. Neste estudo, criamos uma nova métrica que operacionaliza essa resitência: $G_{norm}$.

Nas duas redes reais estudadas, a distribuição dos valores de $G_{norm}$ ficou de acordo com o usual para métricas de centralide. Isto é, poucas espécies ficaram acima da média da rede e a maioria ficou próxima ou abaixo da média. Isso demonstra que são poucas as espécies que atingem alta centralidade $G_{norm}$. Além disso, o ranking das espécies com maior $G_{norm}$ difere dos rankings observados para outras métricas de centralidade muito usadas na literatura.

Além dessa diferença entre rankings, $G_{norm}$ apresentou outro compotamento peculiar. A distribuição de $G_{norm}$ para redes aleatórias não apresentou a mesma forma observada para as redes Morcego-Planta e Formiga-Planta, especialmente no caso das redes com duas camadas. Já as redes redes aleatórias com de três a cinco camadas apresentaram uma distribuição de $G_{norm}$ mais parecida com a observada entre as redes ecológicas. Isso pode ser atribuido ao fato de que, quanto mais camadas uma rede possuir, maior é o valor máximo possível de $G_{norm}$, mas os valores baixos não mudam muito, fazendo com que a cauda fique mais alongada para o lado direito.

Outra diferença digna de nota é entre os parâmetros usados para analisar a modularidade multicamada e calcular $G_{norm}$. A variação da resolução $\gamma$ não parece influenciar G de forma tão intensa quanto a variação no acoplamento $\omega$, mas ela também mostrou ter um efeito sobre essa nova métrica. Portanto, é robusto selecionar nós com alto $G_{norm}$ como candidatos a hubs e conectores, considerando também a variação em $\gamma$ . Assim, diminuimos a probabilidade de estarmos observando uma exceção dentro de um grande universo de parâmetros de resolução, além de identificar as espécies importantes de uma forma mais generalizada.

Nos casos em que porventura existir uma variação significativa de $G_{norm}$ em relação a $\gamma$, podemos concluir que as espécies com alto $G_{norm}$ podem ter sua importância aumentada ou diminuída, caso estejamos interessados em grupos maiores ou menores. Isto pode ocorrer, já que a importância do nó operacionalizada por $G_{norm}$ se baseia na distribuição dos módulos. Nesse caso, um especialista na área temática da rede estudada poderia interpretar qual a resolução deveria ser utilizada, com base nas propriedades do sistema.

Outro ponto em que o olhar de um especialista pode enxergar grande valor na métrica $G_{norm}$ é o ranking de centralidade dos nós. Quando avaliamos as 10 espécies mais bem ranqueadas das redes ecológicas reais, vimos que as espécies com altos valores de $G_{norm}$ possuem alguma sobreposição com as espécies tidas como centrais por outras métricas nas redes Formiga-Planta (60% - 70% dependendo da métrica) e Morcego-Planta (40% - 70% dependendo da métrica). Isso é interessante, já que o ranqueamento das espécies foi feito levando-se em conta a resistência de cada uma delas ao parâmetro de acoplamento entre camadas $\omega$. Esse é um critério muito diferente dos adotados pelas outras métricas de centralidade avaliados. As correlaçoes de Spearman e Pearson também retornaram valores positivos, porém não muito altos, reforçando que as outras métricas e $G_{norm}$ se sobrepõe de diferentes formas, mas contam histórias diferentes. Já para as redes aleatórias, a correlação entre os rankings obtidos com $G_{norm}$ e com as outras métricas de centralidade monocamada foi menor e variou ainda mais, como esperado.

Algo ainda mais interessante que a similaridade entre as espécies entre os rankings de centralidade, são as diferenças finas em termos de quais nós figuram nesses rankings. As espécies mais bem ranqueadas apenas pelos valores de $G_{norm}$ e que não foram bem ranqueadas pelas outras centralidades estudadas talvez possuam uma importância diferenciada dentro da rede multicamada. Essa importância escapa à identificação por métricas monocamada, o que reforça o valor de estudarmos redes multicamadas usando análises que respeitem sua estrutura original, sem agregar as interações de diferentes tipos.

Por exemplo, no caso das interações entre morcegos e plantas, já foi apontado, com base em análises de redes monocamada [@mello2014] e também de redes multicamada [@Mello2019], que espécies de morcegos como *Artibeus jamaicensis* (Artjam) e *Anoura caudifer* (Anocau) seriam hubs ou conectoras. Trata-se de morcegos que focam mais em frutos ou flores, respectivamente, mas que são capaz de consumir ambos os recursos. Por isso, além de atingirem altos valores de centralidade monocamada, elas também atingem altos valores de centralidade multicamada. Contudo, no presente estudo, vimos que, levando-se em conta o acomplamento e a resolução da estrutura modular da rede multicamada, outras espécies, como *Artibeus concolor* (Artcon) e *Platyrrhinus helleri* (Plahel) podem ser ainda mais importantes como pontes entre mundos diferentes, devido à sua alta resistência à variação no parâmetro de acoplamento, traduzida como permanência em módulos diferentes em camadas diferentes. O mesmo ocorre com formigas como *Dorymyrmex* *goeldii* (Dorgoe) e *Brachymyrmex* sp1 (Brasp1), que são identificadas como muito centrais apenas pela nova métrica. Estudar essas espécies bem ranqueadas apenas por $G_{norm}$ pode levar a novos insights sobre como o papel funcional de mutualistas e antagonistas é determinado por sua ecologia e evolução.

Essas peculiaridades nos levam a sugerir também que a nova métrica de centralidade $G_{norm}$ poderia ser usada para identificar espécies-chave em redes de interações ecológicas. Espécies identificadas por essa métrica, mesmo que identificadas também por outras métricas multicamada, são muito importantes para a transferência de informação por vias diretas e indiretas em sistemas ecológicos. Essas vias unem diferentes grupos de plantas, de diferentes famílias e que produzem diferentes tipos de recursos essenciais para manter populações de animais.

\pagebreak

\clearpage

# Referências

::: {#refs}
:::

\pagebreak

\clearpage

# Anexo I - Tabela de referência entre códigos e nomes científicos das espécies da rede Morcego-Planta

\centering
\footnotesize
\tablefirsthead{\toprule Nome científico & Código & Taxon \\ \midrule}

\tablehead{%
\multicolumn{3}{c}%
{{\bfseries  Continuação da página anterior}} \\
\toprule Nome científico & Código & Taxon\\ \midrule}

\tabletail{%
\midrule \multicolumn{3}{r}{{Continua na próxima página}} \\ \midrule}
\tablelasttail{%
\\\midrule
\multicolumn{3}{r}{{Final}} \\ \bottomrule}
\begin{supertabular}{lll}
\textit{Anoura caudifer               } & Anocau          & Morcego        \\
\textit{Anoura fistulata              } & Anofis          & Morcego        \\
\textit{Anoura geoffroyi              } & Anogeo          & Morcego        \\
\textit{Ardops nichollsi              } & Ardnic          & Morcego        \\
\textit{Artibeus cinereus             } & Artcin          & Morcego        \\
\textit{Artibeus concolor             } & Artcon          & Morcego        \\
\textit{Artibeus fimbriatus           } & Artfim          & Morcego        \\
\textit{Artibeus flavescens           } & Artfla          & Morcego        \\
\textit{Artibeus gnomus               } & Artgno          & Morcego        \\
\textit{Artibeus hirsutus             } & Arthir          & Morcego        \\
\textit{Artibeus jamaicensis          } & Artjam          & Morcego        \\
\textit{Artibeus lituratus            } & Artlit          & Morcego        \\
\textit{Artibeus obscurus             } & Artobs          & Morcego        \\
\textit{Artibeus phaeotis             } & Artpha          & Morcego        \\
\textit{Artibeus planirostris         } & Artpla          & Morcego        \\
\textit{Artibeus toltecus             } & Arttol          & Morcego        \\
\textit{Artibeus watsoni              } & Artwat          & Morcego        \\
\textit{Brachyphylla cavernarum       } & Bracav          & Morcego        \\
\textit{Brachyphylla nana             } & Branan          & Morcego        \\
\textit{Carollia brevicauda           } & Carbre          & Morcego        \\
\textit{Carollia castanea             } & Carcas          & Morcego        \\
\textit{Carollia perspicillata        } & Carper          & Morcego        \\
\textit{Carollia sowelli              } & Carsow          & Morcego        \\
\textit{Carollia subrufa              } & Carsub          & Morcego        \\
\textit{Centurio senex                } & Censen          & Morcego        \\
\textit{Chiroderma doriae             } & Chidor          & Morcego        \\
\textit{Chiroderma salvini            } & Chisal          & Morcego        \\
\textit{Chiroderma trinitatum         } & Chitri          & Morcego        \\
\textit{Chiroderma villosum           } & Chivil          & Morcego        \\
\textit{Choeroniscus godmani          } & Chogod          & Morcego        \\
\textit{Choeronycteris mexicana       } & Chomex          & Morcego        \\
\textit{Ectophylla alba               } & Ectalb          & Morcego        \\
\textit{Enchisthenes hartii           } & Enchar          & Morcego        \\
\textit{Erophylla sezekorni           } & Erosez          & Morcego        \\
\textit{Glossophaga commissarisi      } & Glocom          & Morcego        \\
\textit{Glossophaga leachii           } & Glolea          & Morcego        \\
\textit{Glossophaga longirostris      } & Glolon          & Morcego        \\
\textit{Glossophaga soricina          } & Glosor          & Morcego        \\
\textit{Hylonycteris underwoodi       } & Hylund          & Morcego        \\
\textit{Lampronycteris brachyotis     } & Lambra          & Morcego        \\
\textit{Leptonycteris curasoae        } & Lepcur          & Morcego        \\
\textit{Leptonycteris nivalis         } & Lepniv          & Morcego        \\
\textit{Leptonycteris yerbabuenae     } & Lepyer          & Morcego        \\
\textit{Lichonycteris obscura         } & Licobs          & Morcego        \\
\textit{Lonchophylla bokermanni       } & Lonbok          & Morcego        \\
\textit{Lonchophylla mordax           } & Lonmor          & Morcego        \\
\textit{Lonchophylla robusta          } & Lonrob          & Morcego        \\
\textit{Macrotus waterhousii          } & Macwat          & Morcego        \\
\textit{Mesophylla macconelli         } & Mesmac          & Morcego        \\
\textit{Micronycteris hirsuta         } & Michir          & Morcego        \\
\textit{Micronycteris megalotis       } & Micmeg          & Morcego        \\
\textit{Monophyllus plethodon         } & Monple          & Morcego        \\
\textit{Monophyllus redmani           } & Monred          & Morcego        \\
\textit{Musonycteris harrisoni        } & Mushar          & Morcego        \\
\textit{Phyllonycteris poeyi          } & Phypoe          & Morcego        \\
\textit{Phyllostomus discolor         } & Phydis          & Morcego        \\
\textit{Phyllostomus elongatus        } & Phyelo          & Morcego        \\
\textit{Phyllostomus hastatus         } & Phyhas          & Morcego        \\
\textit{Platalina genovensium         } & Plagen          & Morcego        \\
\textit{Platyrrhinus brachycephalus   } & Plabra          & Morcego        \\
\textit{Platyrrhinus helleri          } & Plahel          & Morcego        \\
\textit{Platyrrhinus lineatus         } & Plalin          & Morcego        \\
\textit{Platyrrhinus recifinus        } & Plarec          & Morcego        \\
\textit{Pygoderma bilabiatum          } & Pygbil          & Morcego        \\
\textit{Rhinophylla pumilio           } & Rhipum          & Morcego        \\
\textit{Stenoderma rufum              } & Steruf          & Morcego        \\
\textit{Sturnira erythromos           } & Stuery          & Morcego        \\
\textit{Sturnira lilium               } & Stulil          & Morcego        \\
\textit{Sturnira ludovici             } & Stulud          & Morcego        \\
\textit{Sturnira oporaphilum          } & Stuopo          & Morcego        \\
\textit{Sturnira tildae               } & Stutil          & Morcego        \\
\textit{Uroderma bilobatum            } & Urobil          & Morcego        \\
\textit{Uroderma magnirostrum         } & Uromag          & Morcego        \\
\textit{Vampyressa nymphaea           } & Vamnym          & Morcego        \\
\textit{Vampyressa pusilla            } & Vampus          & Morcego        \\
\textit{Vampyrodes caraccioli         } & Vamcar          & Morcego        \\
\textit{Vampyrops helleri             } & Vamhel          & Morcego        \\
\textit{Abutilon regnelli             } & Abureg          & Planta         \\
\textit{Acacia collinsii              } & Acacol          & Planta         \\
\textit{Acacia farnesiana             } & Acafar          & Planta         \\
\textit{Acnistus arborescens          } & Acnarb          & Planta         \\
\textit{Acrocomia aculeata            } & Acracu          & Planta         \\
\textit{Adenocalymna dichilum         } & Adedic          & Planta         \\
\textit{Aechmea tillandsioides        } & Aectil          & Planta         \\
\textit{Agave angustifolia            } & Agaang          & Planta         \\
\textit{Agave colimana                } & Agacol          & Planta         \\
\textit{Agave desmettiana             } & Agades          & Planta         \\
\textit{Agave grisea                  } & Agagri          & Planta         \\
\textit{Agave macroacantha            } & Agamac          & Planta         \\
\textit{Agave palmeri                 } & Agapal          & Planta         \\
\textit{Agave schottii                } & Agasch          & Planta         \\
\textit{Agave subsimplex              } & Agasub          & Planta         \\
\textit{Albizia occidentalis          } & Albocc          & Planta         \\
\textit{Alexa grandiflora             } & Alegra          & Planta         \\
\textit{Alnus jorulensis              } & Alnjor          & Planta         \\
\textit{Anacardium excelsum           } & Anaexc          & Planta         \\
\textit{Andira inermis                } & Andine          & Planta         \\
\textit{Annona exsucca                } & Annexs          & Planta         \\
\textit{Annona montana                } & Annmon          & Planta         \\
\textit{Annona muricata               } & Annmur          & Planta         \\
\textit{Annona squamosa               } & Annsqu          & Planta         \\
\textit{Artocarpus integrifolia       } & Artint          & Planta         \\
\textit{Asplundia vagans              } & Aspvag          & Planta         \\
\textit{Bauhinia multinervia          } & Baumul          & Planta         \\
\textit{Bauhinia pauletia             } & Baupau          & Planta         \\
\textit{Bauhinia rufa                 } & Bauruf          & Planta         \\
\textit{Bauhinia ungulata             } & Bauung          & Planta         \\
\textit{Berrya cubensis               } & Bercub          & Planta         \\
\textit{Bignonia diversifolia         } & Bigdiv          & Planta         \\
\textit{Bocoa prouacensis             } & Bocpro          & Planta         \\
\textit{Bombacopsis squamigera        } & Bomsqu          & Planta         \\
\textit{Brosimum alicastrum           } & Broali          & Planta         \\
\textit{Burmeistera borjensis         } & Burbor          & Planta         \\
\textit{Burmeistera ceratocarpa       } & Burcer          & Planta         \\
\textit{Burmeistera cyclostigmata     } & Burcyc          & Planta         \\
\textit{Burmeistera cylindrocarpa     } & Burcyl          & Planta         \\
\textit{Burmeistera lutosa            } & Burlut          & Planta         \\
\textit{Burmeistera multiflora        } & Burmul          & Planta         \\
\textit{Burmeistera smaragdi          } & Bursma          & Planta         \\
\textit{Burmeistera sodiroana         } & Bursod          & Planta         \\
\textit{Burmeistera succulenta        } & Bursuc          & Planta         \\
\textit{Burmeistera truncata          } & Burtru          & Planta         \\
\textit{Byrsonima spicata             } & Byrspi          & Planta         \\
\textit{Caesalpinia vesicaria         } & Caeves          & Planta         \\
\textit{Calliandra laxa               } & Callax          & Planta         \\
\textit{Calophyllum brasiliense       } & Calbra          & Planta         \\
\textit{Calophyllum longifolium       } & Callon          & Planta         \\
\textit{Calycolpus warszewiczianus    } & Calwar          & Planta         \\
\textit{Calyptranthes chytraculia     } & Calchy          & Planta         \\
\textit{Calyptrogyne ghiesbreghtiana  } & Calghi          & Planta         \\
\textit{Campomanesia mediterranea     } & Cammed          & Planta         \\
\textit{Carica papaya                 } & Carpap          & Planta         \\
\textit{Carludovica palmata           } & Carpal          & Planta         \\
\textit{Carnegiea gigantea            } & Cargig          & Planta         \\
\textit{Caryocar Brasiliense          } & CarBra          & Planta         \\
\textit{Caryocar glabrum              } & Cargla          & Planta         \\
\textit{Casimiroa edulis              } & Casedu          & Planta         \\
\textit{Cecropia angustifolia         } & Cecang          & Planta         \\
\textit{Cecropia concolor             } & Ceccon          & Planta         \\
\textit{Cecropia distachya            } & Cecdis          & Planta         \\
\textit{Cecropia ficifolia            } & Cecfic          & Planta         \\
\textit{Cecropia glaziovii            } & Cecgla          & Planta         \\
\textit{Cecropia hololeuca            } & Cechol          & Planta         \\
\textit{Cecropia insignis             } & Cecins          & Planta         \\
\textit{Cecropia membranacea          } & Cecmem          & Planta         \\
\textit{Cecropia obtusa               } & Cecobt          & Planta         \\
\textit{Cecropia obtusifolia          } & Cecobt          & Planta         \\
\textit{Cecropia pachystachya         } & Cecpac          & Planta         \\
\textit{Cecropia Palmata              } & CecPal          & Planta         \\
\textit{Cecropia peltata              } & Cecpel          & Planta         \\
\textit{Cecropia schreberiana         } & Cecsch          & Planta         \\
\textit{Cecropia sciadophylla         } & Cecsci          & Planta         \\
\textit{Ceiba aesculifolia            } & Ceiaes          & Planta         \\
\textit{Ceiba pentandra               } & Ceipen          & Planta         \\
\textit{Celtis iguanaea               } & Celigu          & Planta         \\
\textit{Centropogon nigricans         } & Cennig          & Planta         \\
\textit{Cephalocereus columna-trajani } & Cepcol          & Planta         \\
\textit{Cereus hexagonus              } & Cerhex          & Planta         \\
\textit{Cereus repandus               } & Cerrep          & Planta         \\
\textit{Chelonanthus alatus           } & Cheala          & Planta         \\
\textit{Chrysobalanus icaco           } & Chrica          & Planta         \\
\textit{Chrysophyllum cainito         } & Chrcai          & Planta         \\
\textit{Citrus aurantium              } & Citaur          & Planta         \\
\textit{Clarisia mexicana             } & Clamex          & Planta         \\
\textit{Cleome spinosa                } & Clespi          & Planta         \\
\textit{Clidemia octona               } & Clioct          & Planta         \\
\textit{Clusia flavida                } & Clufla          & Planta         \\
\textit{Cobaea aschersoniana          } & Cobasc          & Planta         \\
\textit{Coccoloba uvifera             } & Cocuvi          & Planta         \\
\textit{Cocos nucifera                } & Cocnuc          & Planta         \\
\textit{Coffea arabica                } & Cofara          & Planta         \\
\textit{Conostegia icosandra          } & Conico          & Planta         \\
\textit{Conostegia volcanalis         } & Convol          & Planta         \\
\textit{Conostegia xalapensis         } & Conxal          & Planta         \\
\textit{Cordia alliodora              } & Corall          & Planta         \\
\textit{Cordia bicolor                } & Corbic          & Planta         \\
\textit{Cordia collococca             } & Corcol          & Planta         \\
\textit{Cordia dentata                } & Corden          & Planta         \\
\textit{Cordia dodecandra             } & Cordod          & Planta         \\
\textit{Cordia gerascanthus           } & Corger          & Planta         \\
\textit{Couma utilis                  } & Couuti          & Planta         \\
\textit{Coussapoa villosa             } & Couvil          & Planta         \\
\textit{Crataeva palmeri              } & Crapal          & Planta         \\
\textit{Crescenti alata               } & Creala          & Planta         \\
\textit{Crescentia cujete             } & Crecuj          & Planta         \\
\textit{Cucurbita argyirosperma       } & Cucarg          & Planta         \\
\textit{Cyathula prostrata            } & Cyapro          & Planta         \\
\textit{Cynometra retusa              } & Cynret          & Planta         \\
\textit{Dendrocereus nudiflorus       } & Dennud          & Planta         \\
\textit{Dendropanax arboreus          } & Denarb          & Planta         \\
\textit{Dichrostachys cinerea         } & Diccin          & Planta         \\
\textit{Diospyros ebenaster           } & Dioebe          & Planta         \\
\textit{Diospyros kaki                } & Diokak          & Planta         \\
\textit{Diospyros mabolo              } & Diomab          & Planta         \\
\textit{Diospyros nigra               } & Dionig          & Planta         \\
\textit{Dipteryx odorata              } & Dipodo          & Planta         \\
\textit{Dipteryx oleifera             } & Dipole          & Planta         \\
\textit{Dipteryx panamensis           } & Dippan          & Planta         \\
\textit{Drymonia rubra                } & Dryrub          & Planta         \\
\textit{Dypsis lutescens              } & Dyplut          & Planta         \\
\textit{Dyssochroma viridiflora       } & Dysvir          & Planta         \\
\textit{Emmotum nitens                } & Emmnit          & Planta         \\
\textit{Encholirium glaziovii         } & Encgla          & Planta         \\
\textit{Eperua falcata                } & Epefal          & Planta         \\
\textit{Epiphyllum hookeri            } & Epihoo          & Planta         \\
\textit{Eriobotrya japonica           } & Erijap          & Planta         \\
\textit{Eriolarynx lorentzii          } & Erilor          & Planta         \\
\textit{Eugenia acapulcensis          } & Eugaca          & Planta         \\
\textit{Eugenia nesiotica             } & Eugnes          & Planta         \\
\textit{Eugenia uniflora              } & Euguni          & Planta         \\
\textit{Euterpe edulis                } & Eutedu          & Planta         \\
\textit{Ficus altissima               } & Ficalt          & Planta         \\
\textit{Ficus aurea                   } & Ficaur          & Planta         \\
\textit{Ficus benjamina               } & Ficben          & Planta         \\
\textit{Ficus cahuitensis             } & Ficcah          & Planta         \\
\textit{Ficus citrifolia              } & Ficcit          & Planta         \\
\textit{Ficus colubrinae              } & Ficcol          & Planta         \\
\textit{Ficus costaricana             } & Ficcos          & Planta         \\
\textit{Ficus cotinifolia             } & Ficcot          & Planta         \\
\textit{Ficus crassinervia            } & Ficcra          & Planta         \\
\textit{Ficus crocata                 } & Ficcro          & Planta         \\
\textit{Ficus eximia                  } & Ficexi          & Planta         \\
\textit{Ficus hartwegii               } & Fichar          & Planta         \\
\textit{Ficus insipida                } & Ficins          & Planta         \\
\textit{Ficus luschnatiana            } & Ficlus          & Planta         \\
\textit{Ficus matiziana               } & Ficmat          & Planta         \\
\textit{Ficus maxima                  } & Ficmax          & Planta         \\
\textit{Ficus nymphaefolia            } & Ficnym          & Planta         \\
\textit{Ficus obtusifolia             } & Ficobt          & Planta         \\
\textit{Ficus paraensis               } & Ficpar          & Planta         \\
\textit{Ficus pertusa                 } & Ficper          & Planta         \\
\textit{Ficus popenoei                } & Ficpop          & Planta         \\
\textit{Ficus religiosa               } & Ficrel          & Planta         \\
\textit{Ficus retusa                  } & Ficret          & Planta         \\
\textit{Ficus skytinodermis           } & Ficsky          & Planta         \\
\textit{Ficus tonduzii                } & Ficton          & Planta         \\
\textit{Ficus trigonata               } & Fictri          & Planta         \\
\textit{Ficus yoponensis              } & Ficyop          & Planta         \\
\textit{Flacourtia indica             } & Flaind          & Planta         \\
\textit{Garcinia intermedia           } & Garint          & Planta         \\
\textit{Guazuma ulmifolia             } & Guaulm          & Planta         \\
\textit{Guettarda foliacea            } & Guefol          & Planta         \\
\textit{Gurania acuminata             } & Guracu          & Planta         \\
\textit{Gurania lobata                } & Gurlob          & Planta         \\
\textit{Gustavia superba              } & Gussup          & Planta         \\
\textit{Harpochilus neesianus         } & Harnee          & Planta         \\
\textit{Hawkesiophyton ulei           } & Hawule          & Planta         \\
\textit{Helicteris baruensis          } & Helbar          & Planta         \\
\textit{Hernandia didymantha          } & Herdid          & Planta         \\
\textit{Hibiscus elatus               } & Hibela          & Planta         \\
\textit{Hillia illustris              } & Hilill          & Planta         \\
\textit{Hohenbergia penduliflora      } & Hohpen          & Planta         \\
\textit{Hura polyandra                } & Hurpol          & Planta         \\
\textit{Hylocereus lemairei           } & Hyllem          & Planta         \\
\textit{Hylocereus undatus            } & Hylund          & Planta         \\
\textit{Hymenaea courbaril            } & Hymcou          & Planta         \\
\textit{Hymenaea stigonocarpa         } & Hymsti          & Planta         \\
\textit{Inga eriocarpa                } & Ingeri          & Planta         \\
\textit{Inga vera                     } & Ingver          & Planta         \\
\textit{Ipomea ampullacea             } & Ipoamp          & Planta         \\
\textit{Karwinskia calderonii         } & Karcal          & Planta         \\
\textit{Kigelia africana              } & Kigafr          & Planta         \\
\textit{Lafoensia glyptocarpa         } & Lafgly          & Planta         \\
\textit{Lafoensia pacari              } & Lafpac          & Planta         \\
\textit{Lafoensia vandelliana         } & Lafvan          & Planta         \\
\textit{Lecythis zabucajo             } & Leczab          & Planta         \\
\textit{Leptocereus arboreus          } & Leparb          & Planta         \\
\textit{Leptocereus santamarinae      } & Lepsan          & Planta         \\
\textit{Leptocereus wrightii          } & Lepwri          & Planta         \\
\textit{Licania arborea               } & Licarb          & Planta         \\
\textit{Livistona chinensis           } & Livchi          & Planta         \\
\textit{Lycianthes glandulosa         } & Lycgla          & Planta         \\
\textit{Lycianthes multiflora         } & Lycmul          & Planta         \\
\textit{Lysiloma latisiliquum         } & Lyslat          & Planta         \\
\textit{Mabea occidentalis            } & Mabocc          & Planta         \\
\textit{Maclura tinctoria             } & Mactin          & Planta         \\
\textit{Malpighia glabra              } & Malgla          & Planta         \\
\textit{Mammea americana              } & Mamame          & Planta         \\
\textit{Manfreda scabra               } & Mansca          & Planta         \\
\textit{Mangifera indica              } & Manind          & Planta         \\
\textit{Manilkara bidentata           } & Manbid          & Planta         \\
\textit{Manilkara zapota              } & Manzap          & Planta         \\
\textit{Marcgravia coriacea           } & Marcor          & Planta         \\
\textit{Marcgravia mexicana           } & Marmex          & Planta         \\
\textit{Marcgravia nepenthoides       } & Marnep          & Planta         \\
\textit{Marcgravia nervosa            } & Marner          & Planta         \\
\textit{Marcgravia pittieri           } & Marpit          & Planta         \\
\textit{Marcgravia polyantha          } & Marpol          & Planta         \\
\textit{Marcgravia serrae             } & Marser          & Planta         \\
\textit{Marcgravia trinitatis         } & Martri          & Planta         \\
\textit{Markea neurantha              } & Marneu          & Planta         \\
\textit{Matisia bracteolosa           } & Matbra          & Planta         \\
\textit{Matisia cordata               } & Matcor          & Planta         \\
\textit{Matisia ochrocalyx            } & Matoch          & Planta         \\
\textit{Melicoccus bijugatus          } & Melbij          & Planta         \\
\textit{Meriania pichinchensis        } & Merpic          & Planta         \\
\textit{Merinthopodium neuranthum     } & Merneu          & Planta         \\
\textit{Mimosa lewisii                } & Mimlew          & Planta         \\
\textit{Mimusops elengi               } & Mimele          & Planta         \\
\textit{Morinda royoc                 } & Morroy          & Planta         \\
\textit{Morus nigra                   } & Mornig          & Planta         \\
\textit{Mucuna holtonii               } & Muchol          & Planta         \\
\textit{Mucuna urens                  } & Mucure          & Planta         \\
\textit{Muntingia calabura            } & Muncal          & Planta         \\
\textit{Musa acuminata                } & Musacu          & Planta         \\
\textit{Musa paradisiaca              } & Muspar          & Planta         \\
\textit{Myrcia paivae                 } & Myrpai          & Planta         \\
\textit{Myrciaria jaboticaba          } & Myrjab          & Planta         \\
\textit{Nectandra ambigens            } & Necamb          & Planta         \\
\textit{Neobuxbaumia tetetzo          } & Neotet          & Planta         \\
\textit{Ochroma pyramidale            } & Ochpyr          & Planta         \\
\textit{Oenocarpus distichus          } & Oendis          & Planta         \\
\textit{Pachycereus pecten-aboriginum } & Pacpec          & Planta         \\
\textit{Pachycereus pringlei          } & Pacpri          & Planta         \\
\textit{Pachycereus weberi            } & Pacweb          & Planta         \\
\textit{Parkia cachimboensis          } & Parcac          & Planta         \\
\textit{Parkia igneiflora             } & Parign          & Planta         \\
\textit{Parkia nitida                 } & Parnit          & Planta         \\
\textit{Parkia pendula                } & Parpen          & Planta         \\
\textit{Parkia platycephala           } & Parpla          & Planta         \\
\textit{Parmentiera aculeata          } & Paracu          & Planta         \\
\textit{Passiflora amethystina        } & Pasame          & Planta         \\
\textit{Passiflora mucronata          } & Pasmuc          & Planta         \\
\textit{Passiflora penduliflora       } & Paspen          & Planta         \\
\textit{Passiflora punctata           } & Paspun          & Planta         \\
\textit{Passiflora quadrangularis     } & Pasqua          & Planta         \\
\textit{Passiflora unipetala          } & Pasuni          & Planta         \\
\textit{Peltophorum adnatum           } & Peladn          & Planta         \\
\textit{Persea americana              } & Perame          & Planta         \\
\textit{Phenakospermum guyannense     } & Pheguy          & Planta         \\
\textit{Philodendron appendiculatum   } & Phiapp          & Planta         \\
\textit{Philodendron cuneatum         } & Phicun          & Planta         \\
\textit{Phoenix dactylifera           } & Phodac          & Planta         \\
\textit{Phytolacca rivinoides         } & Phyriv          & Planta         \\
\textit{Pilocarpus pinnatus           } & Pilpin          & Planta         \\
\textit{Pilosocereus chrysacanthus    } & Pilchr          & Planta         \\
\textit{Pilosocereus lanuginosus      } & Pillan          & Planta         \\
\textit{Pilosocereus moritzianus      } & Pilmor          & Planta         \\
\textit{Pilosocereus tillianus        } & Piltil          & Planta         \\
\textit{Pilosocereus tuberculatus     } & Piltub          & Planta         \\
\textit{Pimenta racemosa              } & Pimrac          & Planta         \\
\textit{Piper aduncum                 } & Pipadu          & Planta         \\
\textit{Piper aequale                 } & Pipaeq          & Planta         \\
\textit{Piper amalago                 } & Pipama          & Planta         \\
\textit{Piper arboreum                } & Piparb          & Planta         \\
\textit{Piper augustum                } & Pipaug          & Planta         \\
\textit{Piper auritum                 } & Pipaur          & Planta         \\
\textit{Piper bisasperatum            } & Pipbis          & Planta         \\
\textit{Piper carrilloanum            } & Pipcar          & Planta         \\
\textit{Piper cenocladum              } & Pipcen          & Planta         \\
\textit{Piper colonense               } & Pipcol          & Planta         \\
\textit{Piper cordulatum              } & Pipcor          & Planta         \\
\textit{Piper crassinervium           } & Pipcra          & Planta         \\
\textit{Piper cyrtopodon              } & Pipcyr          & Planta         \\
\textit{Piper darienense              } & Pipdar          & Planta         \\
\textit{Piper dilatatum               } & Pipdil          & Planta         \\
\textit{Piper divaricatum             } & Pipdiv          & Planta         \\
\textit{Piper dotanum                 } & Pipdot          & Planta         \\
\textit{Piper epigynium               } & Pipepi          & Planta         \\
\textit{Piper friedrichsthalii        } & Pipfri          & Planta         \\
\textit{Piper gaudichaudianum         } & Pipgau          & Planta         \\
\textit{Piper geniculatum             } & Pipgen          & Planta         \\
\textit{Piper gibbosum                } & Pipgib          & Planta         \\
\textit{Piper glabrescens             } & Pipgla          & Planta         \\
\textit{Piper glabrum                 } & Pipgla          & Planta         \\
\textit{Piper grande                  } & Pipgra          & Planta         \\
\textit{Piper hieronymi               } & Piphie          & Planta         \\
\textit{Piper hispidum                } & Piphis          & Planta         \\
\textit{Piper hostmannianum           } & Piphos          & Planta         \\
\textit{Piper jacquemontianum         } & Pipjac          & Planta         \\
\textit{Piper lanceifolium            } & Piplan          & Planta         \\
\textit{Piper lapathifolium           } & Piplap          & Planta         \\
\textit{Piper marginatum              } & Pipmar          & Planta         \\
\textit{Piper mollicarium             } & Pipmol          & Planta         \\
\textit{Piper multiplinervium         } & Pipmul          & Planta         \\
\textit{Piper obliquum                } & Pipobl          & Planta         \\
\textit{Piper peltatum                } & Pippel          & Planta         \\
\textit{Piper phytolaccifolium        } & Pipphy          & Planta         \\
\textit{Piper reticulatum             } & Pipret          & Planta         \\
\textit{Piper sanctum                 } & Pipsan          & Planta         \\
\textit{Piper secundum                } & Pipsec          & Planta         \\
\textit{Piper trigonum                } & Piptri          & Planta         \\
\textit{Piper tuberculatum            } & Piptub          & Planta         \\
\textit{Piper tucumanum               } & Piptuc          & Planta         \\
\textit{Piper umbellatum              } & Pipumb          & Planta         \\
\textit{Pitcairnia brongniartiana     } & Pitbro          & Planta         \\
\textit{Plinia pinnata                } & Plipin          & Planta         \\
\textit{Poraqueiba sericea            } & Porser          & Planta         \\
\textit{Poulsenia armata              } & Pouarm          & Planta         \\
\textit{Pouteria caimito              } & Poucai          & Planta         \\
\textit{Pouteria campechiana          } & Poucam          & Planta         \\
\textit{Pouteria multiflora           } & Poumul          & Planta         \\
\textit{Pouteria reticulata           } & Pouret          & Planta         \\
\textit{Pouteria sapota               } & Pousap          & Planta         \\
\textit{Prestoea acuminata            } & Preacu          & Planta         \\
\textit{Protium araguense             } & Proara          & Planta         \\
\textit{Prunus persica                } & Pruper          & Planta         \\
\textit{Pseudanamomis umbellulifera   } & Pseumb          & Planta         \\
\textit{Pseudobombax ellipticum       } & Pseell          & Planta         \\
\textit{Pseudobombax grandiflorum     } & Psegra          & Planta         \\
\textit{Pseudobombax septenatum       } & Psesep          & Planta         \\
\textit{Pseudolmedia glabrata         } & Psegla          & Planta         \\
\textit{Psidium guajava               } & Psigua          & Planta         \\
\textit{Psidium guianense             } & Psigui          & Planta         \\
\textit{Psychotria carthagenensis     } & Psycar          & Planta         \\
\textit{Putranjiva roxburghii         } & Putrox          & Planta         \\
\textit{Quararibea asterolepis        } & Quaast          & Planta         \\
\textit{Quararibea funebris           } & Quafun          & Planta         \\
\textit{Quararibea parvifolia         } & Quapar          & Planta         \\
\textit{Randia armata                 } & Ranarm          & Planta         \\
\textit{Rhizophora mangle             } & Rhiman          & Planta         \\
\textit{Rollinia mucosa               } & Rolmuc          & Planta         \\
\textit{Roystonea oleracea            } & Royole          & Planta         \\
\textit{Roystonea regia               } & Royreg          & Planta         \\
\textit{Rubus brasiliensis            } & Rubbra          & Planta         \\
\textit{Sabal palmetto                } & Sabpal          & Planta         \\
\textit{Sacoglottis guianensis        } & Sacgui          & Planta         \\
\textit{Sapindus saponaria            } & Sapsap          & Planta         \\
\textit{Saurauia montana              } & Saumon          & Planta         \\
\textit{Schultesianthus venosus       } & Schven          & Planta         \\
\textit{Senna bacillaris              } & Senbac          & Planta         \\
\textit{Senna fructicosa              } & Senfru          & Planta         \\
\textit{Senna undulata                } & Senund          & Planta         \\
\textit{Sideroxylon capiri            } & Sidcap          & Planta         \\
\textit{Sideroxylon foetidissimum     } & Sidfoe          & Planta         \\
\textit{Siphocampylus sulfureus       } & Sipsul          & Planta         \\
\textit{Socratea exorrhiza            } & Socexo          & Planta         \\
\textit{Solanum aligerum              } & Solali          & Planta         \\
\textit{Solanum aphyodendron          } & Solaph          & Planta         \\
\textit{Solanum arboreum              } & Solarb          & Planta         \\
\textit{Solanum argenteum             } & Solarg          & Planta         \\
\textit{Solanum asperolanatum         } & Solasp          & Planta         \\
\textit{Solanum asperum               } & Solasp          & Planta         \\
\textit{Solanum caavurana             } & Solcaa          & Planta         \\
\textit{Solanum cinnamomeum           } & Solcin          & Planta         \\
\textit{Solanum confusum              } & Solcon          & Planta         \\
\textit{Solanum donianum              } & Soldon          & Planta         \\
\textit{Solanum erianthum             } & Soleri          & Planta         \\
\textit{Solanum grandiflorum          } & Solgra          & Planta         \\
\textit{Solanum granuloso-leprosum    } & Solgra          & Planta         \\
\textit{Solanum hayesii               } & Solhay          & Planta         \\
\textit{Solanum hazenii               } & Solhaz          & Planta         \\
\textit{Solanum hirtum                } & Solhir          & Planta         \\
\textit{Solanum jamaicense            } & Soljam          & Planta         \\
\textit{Solanum lanceolatum           } & Sollan          & Planta         \\
\textit{Solanum leucocarpon           } & Solleu          & Planta         \\
\textit{Solanum megalochiton          } & Solmeg          & Planta         \\
\textit{Solanum nigricans             } & Solnig          & Planta         \\
\textit{Solanum paniculatum           } & Solpan          & Planta         \\
\textit{Solanum paranense             } & Solpar          & Planta         \\
\textit{Solanum pseudocapsicum        } & Solpse          & Planta         \\
\textit{Solanum pseudoquina           } & Solpse          & Planta         \\
\textit{Solanum riparium              } & Solrip          & Planta         \\
\textit{Solanum rovirosanum           } & Solrov          & Planta         \\
\textit{Solanum rudepannum            } & Solrud          & Planta         \\
\textit{Solanum rufescens             } & Solruf          & Planta         \\
\textit{Solanum rugosum               } & Solrug          & Planta         \\
\textit{Solanum sanctaecatharinae     } & Solsan          & Planta         \\
\textit{Solanum scuticum              } & Solscu          & Planta         \\
\textit{Solanum subinerme             } & Solsub          & Planta         \\
\textit{Solanum subsylvestre          } & Solsub          & Planta         \\
\textit{Solanum swartzianum           } & Solswa          & Planta         \\
\textit{Solanum symmetricum           } & Solsym          & Planta         \\
\textit{Solanum tenuispinum           } & Solten          & Planta         \\
\textit{Solanum trichoneuron          } & Soltri          & Planta         \\
\textit{Solanum umbellatum            } & Solumb          & Planta         \\
\textit{Solanum variabile             } & Solvar          & Planta         \\
\textit{Souroubea guianensis          } & Sougui          & Planta         \\
\textit{Spondias dulcis               } & Spodul          & Planta         \\
\textit{Spondias mombin               } & Spomom          & Planta         \\
\textit{Spondias purpurea             } & Spopur          & Planta         \\
\textit{Spondias radlkoferi           } & Sporad          & Planta         \\
\textit{Stenocereus griseus           } & Stegri          & Planta         \\
\textit{Stenocereus queretaroensis    } & Steque          & Planta         \\
\textit{Stenocereus stellatus         } & Steste          & Planta         \\
\textit{Stenocereus thurberi          } & Stethu          & Planta         \\
\textit{Subpilocereus horrispinus     } & Subhor          & Planta         \\
\textit{Swartzia panacoco             } & Swapan          & Planta         \\
\textit{Syagrus romanzoffiana         } & Syarom          & Planta         \\
\textit{Symphonia globulifera         } & Symglo          & Planta         \\
\textit{Syzygium cumini               } & Syzcum          & Planta         \\
\textit{Syzygium jambos               } & Syzjam          & Planta         \\
\textit{Syzygium lineatum             } & Syzlin          & Planta         \\
\textit{Syzygium malaccense           } & Syzmal          & Planta         \\
\textit{Talipariti elatum             } & Talela          & Planta         \\
\textit{Terminalia catappa            } & Tercat          & Planta         \\
\textit{Tetrastylis ovalis            } & Tetova          & Planta         \\
\textit{Theobroma cacao               } & Thecac          & Planta         \\
\textit{Thoracocarpus bissectus       } & Thobis          & Planta         \\
\textit{Thunbergia grandiflora        } & Thugra          & Planta         \\
\textit{Thyrsodium guianense          } & Thygui          & Planta         \\
\textit{Thyrsodium spruceanum         } & Thyspr          & Planta         \\
\textit{Trema micrantha               } & Tremic          & Planta         \\
\textit{Trichanthera gigantea         } & Trigig          & Planta         \\
\textit{Turpinia occidentalis         } & Turocc          & Planta         \\
\textit{Vassobia breviflora           } & Vasbre          & Planta         \\
\textit{Vismia baccifera              } & Visbac          & Planta         \\
\textit{Vismia cayennensis            } & Viscay          & Planta         \\
\textit{Vismia duckei                 } & Visduc          & Planta         \\
\textit{Vismia glabra                 } & Visgla          & Planta         \\
\textit{Vismia guianensis             } & Visgui          & Planta         \\
\textit{Vismia latifolia              } & Vislat          & Planta         \\
\textit{Vismia lauriformis            } & Vislau          & Planta         \\
\textit{Vismia macrophylla            } & Vismac          & Planta         \\
\textit{Vismia panamensis             } & Vispan          & Planta         \\
\textit{Vismia sessilifolia           } & Visses          & Planta         \\
\textit{Vismia tormentosa             } & Vistor          & Planta         \\
\textit{Vitis vinifera                } & Vitvin          & Planta         \\
\textit{Vriesea bituminosa            } & Vribit          & Planta         \\
\textit{Vriesea imperialis            } & Vriimp          & Planta         \\
\textit{Vriesea longiscapa            } & Vrilon          & Planta         \\
\textit{Vriesea moehringiana          } & Vrimoe          & Planta         \\
\textit{Vriesea sazimae               } & Vrisaz          & Planta         \\
\textit{Weberbauerocereus weberbaueri } & Webweb          & Planta         \\
\textit{Weberocereus biolleyi         } & Webbio          & Planta         \\
\textit{Weberocereus trichophorus     } & Webtri          & Planta         \\
\textit{Weberocereus tunilla          } & Webtun          & Planta         \\
\textit{Werauhia gladioliflora        } & Wergla          & Planta         \\
\textit{Xanthosoma microrhiza         } & Xanmic          & Planta         \\
\textit{Zapoteca formosa              } & Zapfor          & Planta         \\
\hline

\end{supertabular}

\pagebreak
\clearpage

# Anexo II - Tabela de referência entre códigos e nomes científicos das espécies da rede Formiga-Planta
\centering
\footnotesize
\tablefirsthead{\toprule Nome científico & Código & Taxon \\ \midrule}

\tablehead{%
\multicolumn{3}{c}%
{{\bfseries  Continuação da página anterior}} \\
\toprule Nome científico & Código & Taxon\\ \midrule}

\tabletail{%
\midrule \multicolumn{3}{r}{{Continua na próxima página}} \\ \midrule}
\tablelasttail{%
\\\midrule
\multicolumn{3}{r}{{Final}} \\ \bottomrule}
\begin{supertabular}{lll}

\textit{Atta Attlae}             & Attlae & Formiga \\
\textit{Brachymyrmex Bracor}     & Bracor & Formiga \\
\textit{Brachymyrmex Brapic}     & Brapic & Formiga \\
\textit{Brachymyrmex Brasp1}     & Brasp1 & Formiga \\
\textit{Camponotus Cambla}       & Cambla & Formiga \\
\textit{Camponotus Camcra}       & Camcra & Formiga \\
\textit{Camponotus Camley}       & Camley & Formiga \\
\textit{Camponotus Camruf}       & Camruf & Formiga \\
\textit{Camponotus Camtra}       & Camtra & Formiga \\
\textit{Camponotus Camvit}       & Camvit & Formiga \\
\textit{Camponotus Camwes}       & Camwes & Formiga \\
\textit{Cephalotes Cepedu}       & Cepedu & Formiga \\
\textit{Cephalotes Ceppus}       & Ceppus & Formiga \\
\textit{Crematogaster Crecri}    & Crecri & Formiga \\
\textit{Crematogaster Creere}    & Creere & Formiga \\
\textit{Dorymyrmex Dorgoe}       & Dorgoe & Formiga \\
\textit{Dorymyrmex Dorsp1}       & Dorsp1 & Formiga \\
\textit{Dorymyrmex Dorsp2}       & Dorsp2 & Formiga \\
\textit{Ectatomma Ectede}        & Ectede & Formiga \\
\textit{Ectatomma Ecttub}        & Ecttub & Formiga \\
\textit{Linepithema Linmic}      & Linmic & Formiga \\
\textit{Linepithema Linsp1}      & Linsp1 & Formiga \\
\textit{Nesomyrmex Nessp1}       & Nessp1 & Formiga \\
\textit{Nesomyrmex Nesspi}       & Nesspi & Formiga \\
\textit{Pheidole Pheoxy}         & Pheoxy & Formiga \\
\textit{Pheidole Phetri}         & Phetri & Formiga \\
\textit{Pseudomyrmex Psegra}     & Psegra & Formiga \\
\textit{Pseudomyrmex Psepal}     & Psepal & Formiga \\
\textit{Pseudomyrmex Pseter}     & Pseter & Formiga \\
\textit{Wasmannia Wasaur}        & Wasaur & Formiga \\
\textit{Aspilia Aspjol}          & Aspjol & Planta  \\
\textit{Baccharis Baccon}        & Baccon & Planta  \\
\textit{Banisteriopsis Banang}   & Banang & Planta  \\
\textit{Banisteriopsis Bancam}   & Bancam & Planta  \\
\textit{Barbacenia Barfla}       & Barfla & Planta  \\
\textit{Bernardia Bersim}        & Bersim & Planta  \\
\textit{Bionia Biocor}           & Biocor & Planta  \\
\textit{Byrsonima Byrsp1}        & Byrsp1 & Planta  \\
\textit{Byrsonima Byrvar}        & Byrvar & Planta  \\
\textit{Camptosema Camcor}       & Camcor & Planta  \\
\textit{Chamaecrista Chacip}     & Chacip & Planta  \\
\textit{Chamaecrista Chades}     & Chades & Planta  \\
\textit{Chamaecrista Chapap}     & Chapap & Planta  \\
\textit{Chamaecrista Charam}     & Charam & Planta  \\
\textit{Chromolaena Chrsp1}      & Chrsp1 & Planta  \\
\textit{Coccoloba Cocacr}        & Cocacr & Planta  \\
\textit{Coccoloba Coccer}        & Coccer & Planta  \\
\textit{Croton Crosp1}           & Crosp1 & Planta  \\
\textit{Cuphea Cuperi}           & Cuperi & Planta  \\
\textit{Dalbergia Dalmis}        & Dalmis & Planta  \\
\textit{Dasyphyllum Dasret}      & Dasret & Planta  \\
\textit{Davila Davell}           & Davell & Planta  \\
\textit{Declieuxia Decdel}       & Decdel & Planta  \\
\textit{Dioidia Diomel}          & Diomel & Planta  \\
\textit{Diplusodon Diporb}       & Diporb & Planta  \\
\textit{Echinocoryne Echsch}     & Echsch & Planta  \\
\textit{Eriope Erihyp}           & Erihyp & Planta  \\
\textit{Erythroxylum Erycam}     & Erycam & Planta  \\
\textit{Gaylussacia Gaymon}      & Gaymon & Planta  \\
\textit{Guapira Guanox}          & Guanox & Planta  \\
\textit{Hyptis Hypsp1}           & Hypsp1 & Planta  \\
\textit{Kielmeyera Kiepet}       & Kiepet & Planta  \\
\textit{Kielmeyera Kiereg}       & Kiereg & Planta  \\
\textit{Lamiaceae Lamsp1}        & Lamsp1 & Planta  \\
\textit{Lavoisiera Lavcon}       & Lavcon & Planta  \\
\textit{Lavoisiera Lavcor}       & Lavcor & Planta  \\
\textit{Lavoisiera Lavsp1}       & Lavsp1 & Planta  \\
\textit{Lessingianthus Leswar}   & Leswar & Planta  \\
\textit{Lippia Lipflo}           & Lipflo & Planta  \\
\textit{Lippia Lipsp1}           & Lipsp1 & Planta  \\
\textit{Luxemburgia Luxsch}      & Luxsch & Planta  \\
\textit{Lychnophora Lycram}      & Lycram & Planta  \\
\textit{Lychnophora Lycrup}      & Lycrup & Planta  \\
\textit{Melastomataceae Melsp1}  & Melsp1 & Planta  \\
\textit{Miconia Micfer}          & Micfer & Planta  \\
\textit{Microlicia Micful}       & Micful & Planta  \\
\textit{Mikania Mikita}          & Mikita & Planta  \\
\textit{Mikania Mikneu}          & Mikneu & Planta  \\
\textit{Myrsine Myrmon}          & Myrmon & Planta  \\
\textit{Myrcia Myrsp1}           & Myrsp1 & Planta  \\
\textit{Neea Neethe}             & Neethe & Planta  \\
\textit{Ouratea Oursem}          & Oursem & Planta  \\
\textit{Paepalanthus Paevel}     & Paevel & Planta  \\
\textit{Palicourea Palrig}       & Palrig & Planta  \\
\textit{Peixotoa Peitom}         & Peitom & Planta  \\
\textit{Philodendron Phicip}     & Phicip & Planta  \\
\textit{Pilosocereus Pilcip}     & Pilcip & Planta  \\
\textit{Pseudobrickellia Pseang} & Pseang & Planta  \\
\textit{Qualea Quacor}           & Quacor & Planta  \\
\textit{Remijia Remfer}          & Remfer & Planta  \\
\textit{Roupala Roumon}          & Roumon & Planta  \\
\textit{Ruellia Ruevil}          & Ruevil & Planta  \\
\textit{Sabiceae Sabbra}         & Sabbra & Planta  \\
\textit{Sapium Sapgla}           & Sapgla & Planta  \\
\textit{sp1 sp1}                 & sp1    & Planta  \\
\textit{Spigelia Spisel}         & Spisel & Planta  \\
\textit{Syagrus Syagla}          & Syagla & Planta  \\
\textit{Symphyopappus Symret}    & Symret & Planta  \\
\textit{Tetrapiterys Tetmic}     & Tetmic & Planta  \\
\textit{Tibouchina Tibcar}       & Tibcar & Planta  \\
\textit{Trembleya Trelan}        & Trelan & Planta  \\
\textit{Trigonia Tricip}         & Tricip & Planta  \\
\textit{Vellozia Velala}         & Velala & Planta  \\
\textit{Vellozia Velalo}         & Velalo & Planta  \\
\textit{Vellozia Velcor}         & Velcor & Planta  \\
\textit{Vellozia Velnan}         & Velnan & Planta  \\
\textit{Vellozia Velniv}         & Velniv & Planta  \\
\textit{Vochysia Vocthy}         & Vocthy & Planta  \\
\hline

\end{supertabular}

